!function(e){var t={};function r(n){if(t[n])return t[n].exports;var o=t[n]={i:n,l:!1,exports:{}};return e[n].call(o.exports,o,o.exports,r),o.l=!0,o.exports}r.m=e,r.c=t,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)r.d(n,o,function(t){return e[t]}.bind(null,o));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=8)}([function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});class n extends Error{constructor(e,t="errCommon"){if(super(),this.isError=!1,Error.captureStackTrace(this,this.constructor),"errServer"==t&&(t="errCommon",console.log(`\n${(new Date).toUTCString()} :-`),console.log(e)),"object"==typeof e){if(void 0!==e.errCommon&&(this.errCommon=e.errCommon),void 0!==e.errModuleWise&&(this.errModuleWise=e.errModuleWise),void 0!==e.HTTP_R_S_Code&&(this.HTTP_R_S_Code=e.HTTP_R_S_Code),void 0!==e.isError&&(this.isError=e.isError),e.errCommon||e.errModuleWise||e.HTTP_R_S_Code)return this;this[t]=[],e instanceof Error?(console.log(`\n${(new Date).toUTCString()} :-`),console.log(e),this[t].push({strMessage:"SOMETHING_WENT_WRONG"})):this[t].push({strMessage:e.strMessage,objDetails:e.objDetails}),this.isError=!0}else e&&(this[t]=[],this[t].push({strMessage:e}),this.isError=!0)}add(e,t="errCommon"){if("errServer"==t&&(t="errCommon",console.log(`\n${(new Date).toUTCString()} :-`),console.log(e)),"object"==typeof e){if(void 0!==e.errCommon&&(this.errCommon=e.errCommon),void 0!==e.errModuleWise&&(this.errModuleWise=e.errModuleWise),void 0!==e.HTTP_R_S_Code&&(this.HTTP_R_S_Code=e.HTTP_R_S_Code),e.errCommon||e.errModuleWise||e.HTTP_R_S_Code)return this;void 0===this[t]&&(this[t]=[]),e instanceof Error?(console.log(`\n${(new Date).toUTCString()} :-`),console.log(e),this[t].push({strMessage:"SOMETHING_WENT_WRONG"})):this[t].push({strMessage:e.strMessage,objDetails:e.objDetails}),this.isError=!0}else void 0===this[t]&&(this[t]=[]),this[t].push({strMessage:e}),this.isError=!0}setStatus(e){return this.HTTP_R_S_Code=e,this}send({statusCode:e=400}={}){let t={errCommon:this.errCommon,errModuleWise:this.errModuleWise};return Object.keys(t).forEach(e=>void 0===t[e]?delete t[e]:""),this.HTTP_R_S_Code&&(e=this.HTTP_R_S_Code),{body:t,statusCode:e}}}t.default=n},function(e,t,r){"use strict";function n(e){for(var r in e)t.hasOwnProperty(r)||(t[r]=e[r])}Object.defineProperty(t,"__esModule",{value:!0}),n(r(14)),n(r(16)),n(r(22)),n(r(24)),n(r(27)),n(r(29)),n(r(30)),n(r(33))},function(e,t,r){"use strict";function n(e){for(var r in e)t.hasOwnProperty(r)||(t[r]=e[r])}Object.defineProperty(t,"__esModule",{value:!0}),n(r(42)),n(r(47)),n(r(65)),n(r(72)),n(r(74)),n(r(82)),n(r(86))},function(e,t){e.exports=require("express")},function(e,t,r){"use strict";function n(e){for(var r in e)t.hasOwnProperty(r)||(t[r]=e[r])}Object.defineProperty(t,"__esModule",{value:!0}),n(r(18)),n(r(19)),n(r(20)),n(r(21))},function(e,t){e.exports=require("crypto-js")},function(e,t){e.exports=require("aws-sdk")},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(96),o=r(101),s=r(102),a=r(103),u=o.fileUploadeToS3ControllerFactory();t.fileUploadeToS3Controller=u;const i=s.createCommonItemControllerFactory({createUsersecase:n.createUsersecase});t.createCommonItemController=i;const c=s.getListCommonItemControllerFactory({getListUserUsecase:n.getListUserUsecase});t.getListCommonItemController=c;const l=s.deleteItemControllerFactory({deleteItemUsecase:n.deleteItemUsecase});t.deleteItemController=l;const d=a.getDropDownControllerFactory();t.getDropDownController=d},function(e,t,r){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const o=n(r(3)),s=r(9),a=n(r(10)),u=n(r(11)),i=n(r(0)),c=n(r(12)),l=r(132),d=o.default();try{d.use(u.default()),d.use(l.jwtTokenChecking),d.use(a.default.json()),d.use(a.default.urlencoded({limit:"50mb",extended:!0})),d.use((function(e,t,r,n){e instanceof SyntaxError&&"body"in e?r.status(400).send({errCommon:[{strMessage:"INVALID_JSON"}]}):n()})),d.use("/",c.default),d.listen(s.intPort,(function(){console.log("App is listening on port "+s.intPort)}))}catch(e){console.log(new i.default(e).send().body)}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.intPort=3e3},function(e,t){e.exports=require("body-parser")},function(e,t){e.exports=require("cors")},function(e,t,r){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});let o=n(r(3)).default.Router();o.use("/user",r(13)),o.use("/file",r(94)),o.use("/common",r(105)),o.use("/referral",r(106)),o.use("/course",r(112)),o.use("/news",r(126)),t.default=o},function(e,t,r){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const o=n(r(3)),s=r(1),a=r(34);let u=o.default.Router();u.post("/login_user",s.makeController(a.logInUserController)),u.post("/create_user",s.makeController(a.createUserController)),u.post("/get_user",s.makeController(a.getListUserController)),u.put("/update_user",s.makeController(a.updateUserController)),e.exports=u},function(e,t,r){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const o=n(r(0)),s=n(r(15));t.makeController=function(e){return(t,r)=>{try{const n={body:t.body,query:t.query,params:t.params,ip:t.ip,authorization:t.get("x-access-token"),intUserId:t.intUserId,fkPackageId:t.fkPackageId,strUserType:t.strUserType,method:t.method,timReceived:s.default().format("M/D/YYYY hh:m:s a"),path:t.originalUrl,strAudience:(t.get("str-audience")||"").toUpperCase(),headers:{"Content-Type":t.get("Content-Type"),Referer:t.get("referer"),"User-Agent":t.get("User-Agent")}};e(n).then(({headers:e={"Content-Type":"application/json","Last-Modified":(new Date).toUTCString()},type:t="json",statusCode:n=200,body:o})=>{if(!o)throw new Error("EMPTY_RESPONSE");r.set(e),r.type(t),r.status(n).send(o)}).catch(e=>{let t=new o.default(e).send();r.status(t.statusCode).set({"Content-Type":"application/json","Last-Modified":(new Date).toUTCString()}).send(t.body)})}catch(e){let t=new o.default(e).send();r.status(t.statusCode).set({"Content-Type":"application/json","Last-Modified":(new Date).toUTCString()}).send(t.body)}}}},function(e,t){e.exports=require("moment")},function(e,t,r){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const o=r(17),s=n(r(0)),a=r(4);t.getPgConnection=async function(){try{if(a.OBJ_DB_CONFIG){let e=await new o.Client(a.OBJ_DB_CONFIG);return await e.connect(),e}throw new s.default({strMessage:"CONFIGURATION_MISSING",objDetails:"DATABASE"},"errCommon")}catch(e){throw new s.default(e,"errServer")}}},function(e,t){e.exports=require("pg")},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.USER_MODULE="mdl_user"},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.STR_COMMON_DB_TENANT_ID="postgres",t.STR_COMMON_DB="postgres",t.STR_COMMON_DB_USER_NAME="postgres",t.STR_COMMON_DB_PASSWORD="root123",t.STR_BUCKET_URL="",t.INT_ESTIMATE_DELIVERY_DAYS=10,t.INT_MAX_MASTER_IMAGE_SIZE=100,t.INT_MAX_PRODUCT_IMAGE_SIZE=512,t.INT_MAX_PROFILE_IMAGE_SIZE=50,t.AWS_ACCESS_KEY_ID="AKIA444CFGVCED6W7VAA",t.AWS_SECRET_ACCESS_KEY="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",t.AWS_S3_LOCATION="ap-south-1",t.AWS_S3_MASTER_BUCKET="swizbay",t.AWS_BUCKET_URL="https://swizbay.s3.ap-south-1.amazonaws.com/",t.OBJ_DB_CONFIG={user:"ubuntu",host:"localhost",database:"TRD",password:"ubuntu",port:5432},t.OBJ_MASTER_TYPE={expense:!0,vendor:!0,purchase:!0,material:!0,rental_items:!0},t.OBJ_OPEN_TABLE={tbl_materia:!0,tbl_rental:!0},t.OBJ_Account_TYPE={SUPPLIER:!0,PARTY:!0,CASH:!0,BANK:!0,VENDOR:!0,SALARY:!0,PURCHASE_COMMISION:!0,OTHER_EXPENSE:!0,OTHER_INCOME:!0}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TBL_USER="tbl_user",t.TBL_ACCOUNT="tbl_account",t.TBL_Master="tbl_master"},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.objOpenAPI={"/user/login_user":!0,"/login_user":!0,"/get_drop_down":!0,"/common/get_drop_down":!0,"/create_user":!0,"/user/create_user":!0}},function(e,t,r){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const o=n(r(23)),s=n(r(5)),a=n(r(0));t.hashString=function(e){return new Promise((function(t,r){try{e.length>0?o.default.genSalt(10,(function(r,n){o.default.hash(e,n,(function(e,r){t(r)}))})):r("NULL_INPUT_RECVD")}catch(e){throw new a.default(e)}}))},t.compareHashAndText=function(e,t){return new Promise((async function(r,n){try{if(e&&t){r(await o.default.compareSync(e,t))}else n("NULL_INPUT_RECVD")}catch(e){throw new a.default(e)}}))},t.encryptString=async function(e){return e?(await s.default.AES.encrypt(e,"ABDR")).toString():e},t.decryptString=async function(e,t){return t?(await s.default.AES.decrypt(t,"ABDR")).toString(s.default.enc.Utf8):t}},function(e,t){e.exports=require("bcryptjs")},function(e,t,r){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const o=n(r(25)),s=n(r(0)),a=n(r(26));t.jwtSignIn=async function(e,t){try{let r=await a.default.readFileSync("./config/private.key","utf-8"),n=await({issuer:t.issuer,subject:t.subject,audience:t.audience,algorithm:"RS256"});return await o.default.sign(e,r,n)}catch(e){throw new s.default(e)}},t.jwtVerify=async function(e,t){try{let r=await a.default.readFileSync("./config/public.key","utf-8"),n={issuer:t.issuer,subject:t.subject,audience:t.audience,algorithm:"RS256"};return o.default.verify(e,r,n)}catch(e){throw new s.default(e)}},t.jwtDecode=async function(e){try{return o.default.decode(e,{complete:!0})}catch(e){throw new s.default(e)}}},function(e,t){e.exports=require("jsonwebtoken")},function(e,t){e.exports=require("fs")},function(e,t,r){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const o=n(r(28)),s=n(r(0));async function a(){try{let e=await o.default.createClient();return console.log("redis connected"),e}catch(e){throw new s.default(e)}}t.initializeRedisConn=a,t.setRedisData=async function(e,t){let r=await a();try{return await r.on("error",(function(e){console.error(e)})),r.set(e,t,o.default.print)}catch(e){throw new s.default(e)}finally{await r.quit()}},t.getRedisData=async function(e){let t=await a();return new Promise((function(r,n){try{t.get(e,(function(e,t){t&&r(t),r(null)}))}catch(e){n(new s.default(e))}finally{t.quit()}}))},t.checkPartialKeyExist=async function(e){let t=await a();return new Promise((function(r,n){try{return t.keys(e+"*",(function(e,t){t&&r(t),r(null)}))}catch(e){n(new s.default(e))}finally{t.quit()}}))}},function(e,t){e.exports=require("redis")},function(e,t,r){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const o=n(r(0));t.makeFileController=function(e){return(t,r)=>{try{const n={body:t.body,file:t.file,files:t.files,query:t.query,params:t.params,ip:t.ip,intUserId:t.intUserId,fkPackageId:t.fkPackageId,strUserType:t.strUserType,authorization:t.get("x-access-token"),method:t.method,timReceived:(new Date).toUTCString(),path:t.originalUrl,strAudience:(t.get("str-audience")||"").toUpperCase(),headers:{"Content-Type":t.get("Content-Type"),Referer:t.get("referer"),"User-Agent":t.get("User-Agent")}};e(n).then(({headers:e={"Content-Type":"text/plain","Last-Modified":(new Date).toUTCString()},type:t="json",statusCode:n=200,body:o})=>{if(!o)throw new Error("EMPTY_RESPONSE");r.set(e),r.type(t),r.status(n).send(o)}).catch(e=>{let t=new o.default(e).send();r.status(t.statusCode).set({"Content-Type":"application/json","Last-Modified":(new Date).toUTCString()}).send(t.body)})}catch(e){let t=new o.default(e).send();r.status(t.statusCode).set({"Content-Type":"application/json","Last-Modified":(new Date).toUTCString()}).send(t.body)}}}},function(e,t,r){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const o=r(4),s=n(r(31)),a=n(r(32)),u=n(r(6));let i=`mdlmaster${Date.now()}.jpg`;u.default.config.update({accessKeyId:o.AWS_ACCESS_KEY_ID,secretAccessKey:o.AWS_SECRET_ACCESS_KEY,region:o.AWS_S3_LOCATION});let c=new u.default.S3,l=s.default({storage:a.default({s3:c,bucket:o.AWS_S3_MASTER_BUCKET,metadata:function(e,t,r){r(null,{fieldName:i})},key:function(e,t,r){r(null,i),e.body[i]="https://masteraxef.s3.ap-south-1.amazonaws.com/"+i}})});t.fileUploadToS3=l},function(e,t){e.exports=require("multer")},function(e,t){e.exports=require("multer-s3")},function(e,t,r){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const o=r(4),s=n(r(6)),a=n(r(0));t.multiFilesToS3=async function({arrFiles:e}){try{await s.default.config.update({accessKeyId:o.AWS_ACCESS_KEY_ID,secretAccessKey:o.AWS_SECRET_ACCESS_KEY,region:o.AWS_S3_LOCATION});let t=await new s.default.S3,r={},n="mdlmaster"+Date.now(),a=".jpg";return{arrUrls:await Promise.all(e.map(async(e,s)=>{console.log(e.name);let u=await e.name.split(".");return console.log("arrFilename"),console.log(u),a=await u[u.length-1],r["strImgUrl_"+s]=`${o.AWS_BUCKET_URL}${s}${n}.${a}`,await t.putObject({Bucket:o.AWS_S3_MASTER_BUCKET,Body:e.data,Key:`${s}${n}.${a}`,ACL:"public-read"},(function(e,t){e&&console.log("Error uploading data: ",e)})),{status:!0,url:`${o.AWS_BUCKET_URL}${s}${n}.${a}`}})),...r}}catch(e){throw new a.default(e)}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(35),o=r(36),s=n.createUserControllerFactory({createUserUsecase:o.createUserUsecase});t.createUserController=s;const a=n.logInUserControllerFactory({logInUserUseCase:o.logInUserUseCase});t.logInUserController=a;const u=n.getListUserControllerFactory({getListUserUsecase:o.getListUserUsecase});t.getListUserController=u;const i=n.updateUserControllerFactory({updateUserUsecase:o.updateUserUsecase});t.updateUserController=i},function(e,t,r){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const o=n(r(0));t.createUserControllerFactory=function({createUserUsecase:e}){return async function({body:t,...r}){try{return{body:await e({source:r,body:t})}}catch(e){return new o.default(e).send()}}},t.getListUserControllerFactory=function({getListUserUsecase:e}){return async function({body:t,...r}){try{return{body:await e({source:r,body:t})}}catch(e){return new o.default(e).send()}}},t.logInUserControllerFactory=function({logInUserUseCase:e}){return async function({body:t,...r}){try{return{body:await e({source:r,body:t})}}catch(e){return new o.default(e).send()}}},t.updateUserControllerFactory=function({updateUserUsecase:e}){return async function({body:t,...r}){try{return{body:await e({source:r,body:t})}}catch(e){return new o.default(e).send()}}}},function(e,t,r){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const o=r(37),s=r(39),a=n(r(90)),u=n(r(91)),i=n(r(92)),c=n(r(93)),l=a.default({userEntity:s.userEntity});t.createUserUsecase=l;const d=i.default({getUserDetailsDb:o.getUserDetailsDb});t.logInUserUseCase=d;const f=u.default();t.getListUserUsecase=f;const _=c.default({userUpdateEntity:s.userUpdateEntity});t.updateUserUsecase=_},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});let n=r(38).getUserDetailsDbFactory();t.getUserDetailsDb=n},function(e,t,r){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const o=r(1),s=n(r(0));t.createUserDbFactory=function(){return async function({objUser:e,strTenantId:t}){await o.getPgConnection()}},t.getUserDetailsDbFactory=function(){return async function({strLoginId:e}){const t=await o.getPgConnection();try{const r=`"chrStatus"='N' AND \n                ("strUserName"='${e}' OR "strMobile" ='${e}' OR "strEmail" ='${e}')`;let n=await t.query('SELECT     id AS "intUserId", \n                            "strUserName", \n                            "strPassword",\n                            "strUserType",\n                            "chrStatus",\n                            "strEmail",\n                            "strMobile",\n                            "fkPackageId",\n                            "strImageUrl"\n                    FROM tbl_user WHERE '+r);if(n.rows.length>0)return n=await n.rows[0],n;throw new s.default("INVALID_LOGIN_CREDENTIALS")}catch(e){throw new s.default(e)}finally{t.end()}}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(40),o=r(41),s=n.userEntityFactory();t.userEntity=s;const a=o.userUpdateEntityFactory();t.userUpdateEntity=a},function(e,t,r){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const o=n(r(0)),s=r(1);t.userEntityFactory=function(){return async function({strUserName:e,strPassword:t,strUserType:r,strEmail:n,strMobile:a,fkPackageId:u,strFirstName:i,strImageUrl:c,strReferralCode:l,createdTime:d,createdBy:f,arrReferrals:_}){try{let y=new o.default;if(!e&&e.length<4&&y.add("NAME_LENGTH_LESS"),!a&&a.length<9&&y.add("MOBILE_NO_LESS"),!t&&t.length<5&&y.add("PASSWORD_ERROR"),y.isError)throw y;const E=await s.hashString(t.trim());let w=0,p="";return _&&_.length&&(w=_[0].id,_.forEach(e=>{p+=`(${e.intRewardAmount},${e.fkReferalById},${e.roe},'REFERRAL',{USER_ID}, ${f},'${d}'),`}),p=await p.slice(0,-1)),{strUserQuery:`INSERT INTO tbl_user ("strUserName", "strPassword",  "strMobile", "strEmail", "strFirstName","strImageUrl","strReferralCode", \n                                                   "strUserType", "fkReferalById", "fkPackageId", "chrStatus", "createdBy", "createdTime")\n                                            VALUES ('${e}','${E}','${a}','${n}','${i}','${c||""}','${l||""}',\n                                                    '${r}',${w},${u},'N', ${f},'${d}') RETURNING * ;`,strRewardQuery:`INSERT INTO tbl_reward \n                                 ("intRewardAmount", "fkRewardsUserId", "roe", "strType", "fkRewardsBy",  "createdBy","createdTime")\n                                 VALUES ${p} ;`,strReferralUpdate:` UPDATE tbl_referral_users SET "strReferralStatus" = 'CREATED' ,"fkUserId" = {USER_ID}\n                                     WHERE "strMobile" = '${a}' AND "chrStatus" = 'N' ;`,strTransactionQuery:""}}catch(e){throw new o.default(e)}}}},function(e,t,r){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const o=n(r(0)),s=r(1),a=r(2);t.userUpdateEntityFactory=function(){return async function({intUserId:e,strUserName:t,strPassword:r,strOldPassword:n,strEmail:u,strFirstName:i,strImageUrl:c,updatedTime:l,updatedBy:d}){try{const f=await a.findOne({strTableName:"tbl_user",strWhere:` WHERE  id=${e||d}  `});if(!f)throw new o.default("INVALID USER");if(r&&n){const t=await s.hashString(n.trim());if(await s.compareHashAndText(f.strPassword,t))return{strUpdateQuery:` UPDATE tbl_user SET "strPassword"= '${t}'  WHERE id = ${e} ;`};throw new o.default("OLD PASSWORD COULD NOT VERIFY")}let _=new o.default;if(!t&&t.length<4&&_.add("NAME_LENGTH_LESS"),_.isError)throw _;return{strUpdateQuery:` UPDATE tbl_user SET "strUserName" = '${t}',\n                                                       "strEmail" = '${u}',\n                                                       "strFirstName" = '${i}',\n                                                       "strImageUrl" = '${c}',\n                                                       "updatedTime" = '${l}',\n                                                       "updatedBy" = '${d}'\n                                     WHERE id = ${e||d} ;`}}catch(e){throw new o.default(e)}}}},function(e,t,r){"use strict";function n(e){for(var r in e)t.hasOwnProperty(r)||(t[r]=e[r])}Object.defineProperty(t,"__esModule",{value:!0}),n(r(43)),n(r(44)),n(r(45)),n(r(46))},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getIsoDate=function(e=new Date){return(e=new Date(e)).toISOString().replace(/T/," ").replace(/\..+/,"")}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getFormatedDate=function(e){return e?("0"+(e=new Date(e)).getDate()).slice(-2)+"/"+("0"+(e.getMonth()+1)).slice(-2)+"/"+e.getFullYear():null}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getDbDate=function(e,t="dd/MM/yyyy"){if(!e)return null;let r=e.split("/"),n="";return"dd/MM/yyyy"==t||"yyyy/MM/dd"==t?n=`${r[2]}/${r[1]}/${r[0]}`:"MM/dd/yyyy"==t&&(n=`${r[2]}/${r[0]}/${r[1]}`),n}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getDateFormatChanger=function(e,t){if(!e||!t)return null;let r,n,o;return r=(e=e.replace(/\-/g,"/")).split("/"),o=(t=t.replace(/\-/g,"/")).split("/"),0==o.indexOf("dd")&&(n=`${r[2]}/${r[1]}/${r[0]}`),1==o.indexOf("dd")&&(n=`${r[2]}/${r[0]}/${r[1]}`),n}},function(e,t,r){"use strict";function n(e){for(var r in e)t.hasOwnProperty(r)||(t[r]=e[r])}Object.defineProperty(t,"__esModule",{value:!0}),n(r(48)),n(r(51)),n(r(53)),n(r(56)),n(r(59)),n(r(62))},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){for(var r in e)t.hasOwnProperty(r)||(t[r]=e[r])}(r(49))},function(e,t,r){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const o=r(1),s=n(r(0)),a=n(r(50)),u={"-1":null,1:"mdl_chart_of_account",2:"mdl_chart_of_account",3:"mdl_chart_of_account",4:"mdl_bank_account",5:"mdl_credit_card",6:"mdl_corporate_card",7:"mdl_cash_account",8:"mdl_cheque_account",9:"mdl_cheque_account",10:"mdl_cheque_account",11:"",12:"",13:"",14:"mdl_customer",15:"mdl_supplier",16:"",17:"mdl_airline",18:"",19:"",20:"",21:""};t.accountIsExists=async function({intAccountPk:e=-1,strAccountCode:t="",strAccountName:r="",arrAccountType:n=[]}){let i=await o.getPgConnection();try{r=r.toUpperCase(),e=e||-1;let o,c=await i.query(a.default.strQueryAccountInfo,[e,t,r]),l=new s.default;for(let e of c.rows)o=n.includes(e.int_account_type)?"-1":e.int_account_type,e.strCode==t&&l.add({strMessage:"CODE_DUPLICATE",objDetails:u[o]},"errCommon"),e.strName==r&&l.add({strMessage:"NAME_DUPLICATE",objDetails:u[o]},"errCommon");return l}catch(e){throw new s.default(e)}finally{i.end()}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n={strQueryAccountInfo:'SELECT \n  vchr_third_party_mapping_code AS "strThirdPartyCode",\n  vchr_account_code             AS  "strCode",\n  UPPER(vchr_account_name)      AS   "strName",\n  vchr_display_name             AS    "strDisplayName",\n  int_account_type          \nFROM tbl_account \nWHERE (chr_document_status = \'N\' \n  AND pk_bint_account_id != $1)\n  AND (  vchr_third_party_mapping_code=$2\t\n      OR vchr_account_code=$3 \n      OR UPPER(vchr_account_name)=$4 \n      OR vchr_display_name=$5 )',strGetSystemMappingAccount:"SELECT \t\n               fk_bint_account_id AS \"intAccountPk\" \n      FROM tbl_system_mapping_accounts \n       WHERE vchr_system_mapping_code=$1 AND chr_document_status='N' ",strGetBankChargesAccount:'SELECT \n  b.fk_bint_bank_charge_account_id AS   "intAccountPk",\n  a.vchr_account_code              AS  "strCode",\n  a.vchr_account_name              AS   "strName"\n  FROM tbl_bank AS b\n  LEFT JOIN tbl_account     AS a                               \n     ON b.fk_bint_bank_account_id = a.pk_bint_account_id\n    WHERE   a.pk_bint_account_id = $1 AND b.chr_document_status=\'N\' ',strGetCreditCardChargesAccount:'\n  SELECT \n  pos.fk_bint_expense_acc_id AS   "intAccountPk",\n  a.vchr_account_code              AS  "strCode",\n  a.vchr_account_name              AS   "strName"\n  FROM tbl_credit_card_pos AS pos\n  JOIN tbl_account     AS a                               \n      ON  pos.fk_bint_expense_acc_id = a.pk_bint_account_id\n    WHERE   pos.pk_bint_credit_card_pos_id = $1 AND pos.chr_document_status=\'N\' '};t.default=n},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){for(var r in e)t.hasOwnProperty(r)||(t[r]=e[r])}(r(52))},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.transactionIsExists=async function({strConnection:e,intTransactionPk:t}){}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){for(var r in e)t.hasOwnProperty(r)||(t[r]=e[r])}(r(54))},function(e,t,r){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const o=n(r(0)),s=n(r(55));t.createDataLogsDb=async function({objMainDbConnection:e,strModuleName:t,arrJsonItems:r=[],intUserId:n,timCurrent:a,strReason:u=""}){try{let o=" ",i=" ";r.forEach(e=>{o+=`('${t}','${JSON.stringify(e).replace(/'/g,"''")}','${a}',${n}),`,u&&(i+=`(${e.intPk},\n           '${t}',\n           '${u.replace(/'/g,"''")}',\n           '${a}',\n            ${n}),`)}),o=o.slice(0,-1),i=i.slice(0,-1),await e.query(s.default.strQueryInsertIntoLogTbl+o),u&&await e.query(s.default.strQueryInsertDeleteResonTbl+i)}catch(e){throw new o.default(e)}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});let n={strQueryInsertIntoLogTbl:"INSERT INTO tbl_logs( vchr_module_name,\n                             json_log_item,\n                             time_created,\n                             fk_bint_created_user_id) VALUES ",strQueryInsertDeleteResonTbl:"INSERT INTO tbl_masters_delete_log( \n                              fk_bint_table_pk_id,           \n                              vchr_table_name,                \n                              txt_reason    , \n                              tim_created,               \n                              fk_bint_created_user_id)     VALUES       "};t.default=n},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){for(var r in e)t.hasOwnProperty(r)||(t[r]=e[r])}(r(57))},function(e,t,r){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const o=r(1),s=n(r(0)),a=n(r(58));t.getPermission=async function({source:e,strModule:t}){let r=await o.getPgConnection();try{return(await r.query(a.default.strGetPermission,[e.intUserID,t])).rows[0]}catch(e){throw new s.default(e)}finally{r.end()}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n={strGetPermission:'SELECT        ugp.int_view                                 AS "intView",\n                                     ugp.int_add                                  AS "intAdd",\n                                     ugp.int_update                               AS "intUpdate",\n                                     ugp.int_delete                               AS "intDelete",\n                                     ugp.int_posting                              AS "intPosting",\n                                     ugp.int_print                                AS "intPrint",\n                                     ugp.int_reprint                              AS "intRePrint"\n                                 FROM tbl_user_group_menu_permission AS ugp\n                                 LEFT JOIN tbl_menu AS m \n                                  ON ugp.fk_bint_menu_id=m.pk_bint_menu_id\n                                 LEFT JOIN tbl_user_group AS ug\n                                  ON ug.pk_bint_user_group_id=ugp.fk_bint_user_group_id\n                                 LEFT JOIN tbl_user AS u\n                                  ON u.fk_bint_user_group_id=ug.pk_bint_user_group_id\n                                 WHERE   u.pk_bint_user_id               =$1\n                                     AND m.vchr_menu_name                =$2\n                                      '};t.default=n},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){for(var r in e)t.hasOwnProperty(r)||(t[r]=e[r])}(r(60))},function(e,t,r){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const o=n(r(0)),s=n(r(61));t.getFinancialYearDb=async function(e,t){try{if(!t)return null;return(await e.query(s.default.strQueryGetFinancialYearSettingsTbl,[t])).rows[0]}catch(e){throw new o.default(e)}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});let n={strQueryGetFinancialYearSettingsTbl:'\n  SELECT \n  pk_bint_financial_year_id   AS "intPk",\n  dat_financial_year_start    AS "datStartDate",\n  dat_financial_year_end      AS "datEndDate",\n  chr_financial_year_status   AS "chrStatus"\n  FROM tbl_financial_year\n    WHERE (dat_financial_year_start, dat_financial_year_end) OVERLAPS ($1::DATE,$1::DATE) AND chr_document_status = \'N\' '};t.default=n},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){for(var r in e)t.hasOwnProperty(r)||(t[r]=e[r])}(r(63))},function(e,t,r){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const o=n(r(0)),s=n(r(64)),a=r(2);t.getPkBasedNameDb=async function(e,t,r,n){try{let o={"{WANTED_FIELD_NAME}":""+t,"{TBL_NAME}":""+r,"{WHERE}":n+" AND chr_document_status = 'N' "};return t||r||n?(await e.query(a.multiReplace(s.default.strQueryGetPkOfTblAttribute,o))).rows:null}catch(e){throw new o.default(e)}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});let n={strQueryGetPkOfTblAttribute:"\n  SELECT  \n    {WANTED_FIELD_NAME}\n  FROM {TBL_NAME}\n  WHERE {WHERE}"};t.default=n},function(e,t,r){"use strict";function n(e){for(var r in e)t.hasOwnProperty(r)||(t[r]=e[r])}Object.defineProperty(t,"__esModule",{value:!0}),n(r(66)),n(r(67)),n(r(68)),n(r(69)),n(r(70)),n(r(71))},function(e,t,r){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const o=r(1),s=n(r(0));t.insertQueryRunner=async function({strTableName:e,objValues:t,arrReturnItems:r=[]}){let n="",a="",u="",i=[],c=await o.getPgConnection();try{if(e){if(t&&Object.keys(t).length){await Object.keys(t).forEach((e,r)=>{a+=` ${e},`,u+=`$${r+1},`,i.push(t[e])}),n=`INSERT INTO ${e} (${a.slice(0,-1)}) VALUES (${u.slice(0,-1)}) ${r.length?"RETURNING "+r:" "} ;`,console.log("strQuery"),console.log(n);const o=await c.query(n,i);return console.log(o.rows[0]),o.rows}return null}return null}catch(e){throw e&&23505==e.code?new s.default("DUPLICATE ENTRY"):new s.default(e)}finally{c.end()}},t.insertTransQueryRunner=async function({strTableName:e,objValues:t,arrReturnItems:r=[],objDbConnection:n}){let o="",a="",u="",i=[];try{if(e){if(t&&Object.keys(t).length){await Object.keys(t).forEach((e,r)=>{a+=` ${e},`,u+=`$${r+1},`,i.push(t[e])}),o=`INSERT INTO ${e} (${a.slice(0,-1)}) VALUES (${u.slice(0,-1)}) ${r.length?"RETURNING "+r:" "} ;`,console.log("strQuery"),console.log(o);const s=await n.query(o,i);return console.log(s.rows[0]),s.rows}return null}return null}catch(e){throw await n.query("ROLLBACK"),e&&23505==e.code?new s.default("DUPLICATE ENTRY"):new s.default(e)}},t.insertWithAccQueryRunner=async function({strTableName:e,objValues:t,arrAccValues:r,arrReturnItems:n=[]}){let a="",u="",i="",c=[],l=await o.getPgConnection();try{if(e){if(t&&Object.keys(t).length){await l.query("BEGIN");const o=await l.query(" INSERT INTO tbl_account\n                                                 (str_account_name,\n                                                 str_account_type,\n                                                 fk_created_user_id,\n                                                 tim_created) VALUES ($1,$2,$3,$4) \n                                                 RETURNING pk_account_id",r);if(o&&o.rows&&o.rows[0]&&o.rows[0].pk_account_id){let r={fk_account_id:o.rows[0].pk_account_id,...t};await Object.keys(r).forEach((e,t)=>{u+=` ${e},`,i+=`$${t+1},`,c.push(r[e])}),a=`INSERT INTO ${e} (${u.slice(0,-1)}) VALUES (${i.slice(0,-1)}) ${n.length?"RETURNING "+n:" "} ;`;const s=await l.query(a,c);return console.log(s.rows[0]),await l.query("COMMIT"),s.rows}throw await l.query("ROLLBACK"),new s.default("FAILED")}return null}return null}catch(e){throw await l.query("ROLLBACK"),e&&23505==e.code?new s.default("ACCOUNT NAME DUPLICATE"):new s.default(e)}finally{l.end()}}},function(e,t,r){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const o=r(1),s=n(r(0));t.commonQueryRunner=async function({strQuery:e}){const t=await o.getPgConnection();try{return await t.query(e)}catch(e){throw new s.default(e)}finally{t.end()}}},function(e,t,r){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const o=r(1),s=n(r(0));t.findAll=async function({strTableName:e,strWhere:t="",strColounm:r=" * "}){const n=await o.getPgConnection();try{if(e&&t){const o=`SELECT ${r} FROM ${e} ${t} ;`;console.log("strQuery"),console.log(o);const s=await n.query(o);return console.log(s.rows[0]),s.rows}return null}catch(e){throw new s.default(e)}finally{n.end()}}},function(e,t,r){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const o=r(1),s=n(r(0));t.findOne=async function({strTableName:e,strWhere:t="",strColounm:r=" * "}){const n=await o.getPgConnection();try{if(e&&t){const o=`SELECT ${r} FROM ${e} ${t} ;`;console.log("strQuery"),console.log(o);const s=await n.query(o);return s&&s.rows?s.rows[0]:null}return null}catch(e){throw new s.default(e)}finally{n.end()}}},function(e,t,r){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const o=n(r(0));t.transQueryRunner=async function({strQuery:e,objDbConnection:t}){try{const r=await t.query(e);return r&&r.rows&&r.rows.length?r.rows:!!r.rowCount}catch(e){throw await t.query("ROLLBACK"),e&&23505==e.code?new o.default("DUPLICATE ENTRY"):new o.default(e)}}},function(e,t,r){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const o=n(r(0));t.getQueryRunner=async function({strQuery:e,objDbConnection:t}){try{return await t.query(e)}catch(e){throw new o.default(e)}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){for(var r in e)t.hasOwnProperty(r)||(t[r]=e[r])}(r(73))},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.escape=function(e){return e.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")}},function(e,t,r){"use strict";function n(e){for(var r in e)t.hasOwnProperty(r)||(t[r]=e[r])}Object.defineProperty(t,"__esModule",{value:!0}),n(r(75)),n(r(76)),n(r(77)),n(r(78)),n(r(79)),n(r(80)),n(r(81))},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(2);t.ltrim=function(e,t="\\s"){return e?("\\s"!==t&&(t=n.escape(t)),e.replace(new RegExp("^["+t+"]+","gm"),"")):e}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(2);t.multiReplace=function(e,t){let r=[];for(let e in t)r.push(n.escape(e));return e.replace(new RegExp(r.join("|"),"g"),(function(e){return t[e]}))}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(2);t.rtrim=function(e,t="\\s"){return e?("\\s"!==t&&(t=n.escape(t)),e.replace(new RegExp("["+t+"]+$","gm"),"")):e}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.slugify=function(e,t="U",r="_"){return e?"L"==t?e.replace(/[^a-z0-9]/gi,r).toLowerCase():"U"==t?e.replace(/[^a-z0-9]/gi,r).toLocaleUpperCase():e.replace(/[^a-z0-9]/gi,r):e}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(2);t.trim=function(e,t="\\s"){return e?("\\s"!==t&&(t=n.escape(t)),e.replace(new RegExp("^["+t+"]+|["+t+"]+$","gm"),"")):e}},function(e,t,r){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const o=n(r(5));t.encryptString=function(e,t){return t?o.default.AES.encrypt(t,"ABDU").toString():t}},function(e,t,r){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const o=n(r(5));t.decryptString=function(e,t){return t?o.default.AES.decrypt(t,"ABDU").toString(o.default.enc.Utf8):t}},function(e,t,r){"use strict";function n(e){for(var r in e)t.hasOwnProperty(r)||(t[r]=e[r])}Object.defineProperty(t,"__esModule",{value:!0}),n(r(83)),n(r(84))},function(e,t,r){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const o=n(r(0));t.getJSONToCSV=async function({arrItemList:e,objColumns:t=null,strMainTittle:r,intUserID:n}){try{let n=[],o=[],s=[],a=0;t&&t[Object.keys(t)[0]].forEach(e=>{1==e.blnShow&&(a++,o.push(e.strKey),s.push(e.strHeader))}),e.forEach(e=>{let t=[];o.forEach(r=>{t.push(e[r])}),n.push(t)});let u='"',i=",",c="",l=new Array(a);l[(s.length/2-1).toFixed(0)]=r,c=l+"\n",c+=s+"\n";let d=[];return n.forEach(e=>{let t="";d=e,d.forEach(e=>{t+=`${u}${e.toString()}${u},`}),c+=t+"\n"}),i+=i.replace(/,/g,i),c}catch(e){return new o.default(e)}}},function(e,t,r){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const o=n(r(85)),s=n(r(0));t.getJSONToExcel=async function({arrItemList:e,objColumns:t=null,strMainTittle:r,intUserID:n}){try{let n=[],s=[],a=[];t&&t[Object.keys(t)[0]].forEach(e=>{e.blnShow,s.push(e.strKey),a.push(e.strHeader)});let u={"!cols":[]};a.forEach(e=>{u["!cols"].push({wch:e.length+3})});let i=new Array;return i[(a.length/2-1).toFixed(0)]=r,n.push(i),n.push(a),e.forEach(e=>{let t=[];s.forEach(r=>{t.push(e[r])}),n.push(t)}),o.default.build([{data:n}],u)}catch(e){return new s.default(e)}}},function(e,t){e.exports=require("node-xlsx")},function(e,t,r){"use strict";function n(e){for(var r in e)t.hasOwnProperty(r)||(t[r]=e[r])}Object.defineProperty(t,"__esModule",{value:!0}),n(r(87)),n(r(88)),n(r(89))},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createDataLog=async function({objSession:e,arrOldItem:t,intUserId:r,strCreatedTime:n}){return!0}},function(e,t,r){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const o=r(1),s=n(r(0));t.findRoe=async function(){const e=await o.getPgConnection();try{const t="SELECT * FROM  tbl_roe ORDER BY id DESC LIMIT 1 ;",r=await e.query(t);return console.log(r.rows[0]),r.rows[0]}catch(e){throw new s.default(e)}finally{e.end()}}},function(e,t,r){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const o=r(1),s=n(r(0));t.findUserById=async function(e){const t=await o.getPgConnection();try{const r=`SELECT * FROM  tbl_user WHERE id = ${e} ;`,n=await t.query(r);return console.log(n.rows[0]),n.rows[0]}catch(e){throw new s.default(e)}finally{t.end()}}},function(e,t,r){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const o=n(r(0)),s=r(2),a=r(1);t.default=function({userEntity:e}){return async function({source:t,body:r}){const n=await a.getPgConnection();try{const a=await s.findAll({strTableName:"tbl_referral_users",strWhere:` WHERE ("strReferralCode" = '${r.strReferralCode}' AND "chrStatus" = 'N') ORDER BY "intLevel" ASC LIMIT 3 `});if(!a.length)throw new o.default("NO REFERRALS !!");const u=await e({...r,arrReferrals:a,createdTime:t.timReceived,createdBy:t.intUserId||0});await n.query("BEGIN");const i=await s.transQueryRunner({strQuery:u.strUserQuery,objDbConnection:n});if(i&&i[0]){const e=s.multiReplace(u.strRewardQuery,{"{USER_ID}":i[0].id});console.log(i[0].id,"strRefQuery",e);const t=await s.transQueryRunner({strQuery:e,objDbConnection:n}),r=await s.transQueryRunner({strQuery:u.strReferralUpdate.replace("{USER_ID}",i[0].id),objDbConnection:n});if(t&&r)return await n.query("COMMIT"),{strMessage:"Success"};throw new o.default("FAILED")}return await n.query("ROLLBACK"),{strMessage:"Failed"}}catch(e){throw await n.query("ROLLBACK"),new o.default(e)}finally{n.end()}}}},function(e,t,r){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const o=n(r(0)),s=r(2);t.default=function(){return async function({source:e,body:t}){try{let e=` "chrStatus" ='N' AND "strUserType"='${t.strUserType||"CUSTOMER"}' `;t.strSort,t.strSearch;const r=t.intLimit||100,n=`SELECT ${'* , to_char("createdTime", \'DD MON YYYY at HH12:MI:SS AM\') as "createdTime" '} FROM tbl_user WHERE ${e} LIMIT ${r}`;return{arrList:(await s.commonQueryRunner({strQuery:n})).rows||[]}}catch(e){throw new o.default(e)}}}},function(e,t,r){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const o=r(1),s=n(r(0));t.default=function({getUserDetailsDb:e}){return async function({source:t,body:r}){if(!r.strPassword)throw new s.default("CREDENTIAL_MISSING");console.log(r);const n=await e({strLoginId:r.strLoginId});let a="",u="";if(!await o.compareHashAndText(r.strPassword,n.strPassword))throw new s.default("CREDENTIAL_INVALID");return a=await o.jwtSignIn({intUserId:n.intUserId.toString(),strUserType:n.strUserType.toString(),fkPackageId:n.fkPackageId||"0"},{issuer:"issuer",subject:"IP",audience:"ABDU"}),u=await o.encryptString(a),await delete n.strPassword,{strToken:u,...n}}}},function(e,t,r){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const o=n(r(0)),s=r(2),a=r(1);t.default=function({userUpdateEntity:e}){return async function({source:t,body:r}){const n=await a.getPgConnection();try{const a=await e({...r,updatedTime:t.timReceived,updatedBy:t.intUserId}),u=await s.commonQueryRunner({strQuery:a.strUpdateQuery});if(u&&u.rowCount)return{strMessage:"PROFILE UPDATED",status:!0};throw new o.default("FAILED")}catch(e){throw new o.default(e)}finally{n.end()}}}},function(e,t,r){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const o=n(r(3)),s=n(r(95)),a=r(1),u=r(7);let i=o.default.Router();i.use("/files_upload",s.default()),i.post("/files_upload",a.makeFileController(u.fileUploadeToS3Controller)),e.exports=i},function(e,t){e.exports=require("express-fileupload")},function(e,t,r){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const o=n(r(97)),s=n(r(99)),a=n(r(100)),u=o.default();t.getListUserUsecase=u;const i=s.default();t.createUsersecase=i;const c=a.default();t.deleteItemUsecase=c},function(e,t,r){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const o=r(98),s=n(r(0)),a=r(2);t.default=function(){return async function({source:e,body:t}){try{let e=" \"chrStatus\"='N' ";if(!t.type||!o.objSELECTQueries[t.type])throw new s.default("INVALID TYPE");const r=` ${o.objSELECTQueries[t.type]} WHERE ${e}`;return{arrList:(await a.commonQueryRunner({strQuery:r})).rows||[]}}catch(e){throw new s.default(e)}}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.objSELECTQueries={roe:'SELECT *,count(*) over() As "intTotalCount",\n    to_char("createdTime", \'DD MONTH YYYY at HH12:MI:SS PM\') as "createdTime"     FROM tbl_roe  '}},function(e,t,r){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const o=n(r(0)),s=r(2);t.default=function(){return async function({source:e,body:t}){try{if(!t.type)throw new o.default("INVALID TYPE");switch(t.type){case"roe":{const r=await s.commonQueryRunner({strQuery:`INSERT INTO tbl_roe ("roe","createdBy","createdTime") VALUES (${t.roe},${e.intUserId},'${e.timReceived}');`});return r&&r.rowCount?{strMessage:"ROE CREATED"}:{strMessage:"ROE CREATION FAILED"}}default:return{strMessage:"Failed"}}}catch(e){throw new o.default(e)}}}},function(e,t,r){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const o=n(r(0)),s=r(2);t.default=function(){return async function({source:e,body:t}){try{if(!t.type)throw new o.default("INVALID TYPE");if(!t.id)throw new o.default("INVALID ID");switch(t.type){case"roe":{const e=await s.commonQueryRunner({strQuery:`UPDATE tbl_roe SET "chrStatus" = 'E'\n                                                      WHERE id=${t.id} ;`});return e&&e.rowCount?{strMessage:"ROE DELETED"}:{strMessage:"ROE DELETE FAILED"}}case"question":{const r=await s.commonQueryRunner({strQuery:`UPDATE tbl_questen SET "deletedBy"=${e.intUserId},\n                                                      "deletedTime" = '${e.timReceived}',\n                                                      "chrStatus" = 'N'\n                                                      WHERE id=${t.id}  ;`});return r&&r.rowCount?{strMessage:"QUESTION DELETED"}:{strMessage:"QUESTION DELETE FAILED"}}case"video":{const r=await s.commonQueryRunner({strQuery:`UPDATE tbl_vedios SET "deletedBy"=${e.intUserId},\n                                                      "deletedTime" = '${e.timReceived}',\n                                                      "chrStatus" = 'N'\n                                                      WHERE id=${t.id}  ;`});return r&&r.rowCount?{strMessage:"VIDEO DELETED"}:{strMessage:"VIDEO DELETE FAILED"}}case"comments":{const r=await s.commonQueryRunner({strQuery:`UPDATE tbl_comments SET "deletedBy"=${e.intUserId},\n                                                      "deletedTime" = '${e.timReceived}',\n                                                      "chrStatus" = 'N'\n                                                      WHERE id=${t.id}  ;`});return r&&r.rowCount?{strMessage:"COMMENT DELETED"}:{strMessage:"COMMENT DELETE FAILED"}}default:return{strMessage:"Failed"}}}catch(e){throw new o.default(e)}}}},function(e,t,r){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const o=n(r(0)),s=r(1);t.fileUploadeToS3ControllerFactory=function(){return async function({body:e,files:t,...r}){try{let e;if(!t.images)throw new o.default("FILES_MISSING","errModuleWise");return e=t.images.length>=2?await s.multiFilesToS3({arrFiles:t.images}):await s.multiFilesToS3({arrFiles:[t.images]}),{body:e}}catch(e){return new o.default(e).send()}}}},function(e,t,r){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const o=n(r(0));t.createCommonItemControllerFactory=function({createUsersecase:e}){return async function({body:t,...r}){try{return{body:await e({source:r,body:t})}}catch(e){return new o.default(e).send()}}},t.getListCommonItemControllerFactory=function({getListUserUsecase:e}){return async function({body:t,...r}){try{return{body:await e({source:r,body:t})}}catch(e){return new o.default(e).send()}}},t.deleteItemControllerFactory=function({deleteItemUsecase:e}){return async function({body:t,...r}){try{return{body:await e({source:r,body:t})}}catch(e){return new o.default(e).send()}}}},function(e,t,r){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const o=n(r(0)),s=r(2),a=r(104);t.getDropDownControllerFactory=function(){return async function({body:e,...t}){try{switch(e.type){case"package":return{body:{arrList:(await s.commonQueryRunner({strQuery:a.objQueries.package})).rows||[]}}}return{body:{strMessage:"INVALID TYPE"}}}catch(e){return new o.default(e).send()}}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.objQueries={package:'SELECT "id","strName" FROM tbl_package   WHERE  "chrStatus" = \'N\' ;'}},function(e,t,r){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const o=n(r(3)),s=r(1),a=r(7);let u=o.default.Router();u.post("/create_item",s.makeController(a.createCommonItemController)),u.post("/get_item",s.makeController(a.getListCommonItemController)),u.delete("/delete_item",s.makeController(a.deleteItemController)),u.post("/get_drop_down",s.makeController(a.getDropDownController)),e.exports=u},function(e,t,r){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const o=n(r(3)),s=r(1),a=r(107);let u=o.default.Router();u.post("/create_referral",s.makeController(a.createReferralController)),u.post("/get_referral",s.makeController(a.getReferralController)),e.exports=u},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(108),o=r(111),s=o.createReferralControllerFactory({createReferralUsecase:n.createReferralUsecase});t.createReferralController=s;const a=o.getReferralControllerFactory({getReferralUsecase:n.getReferralUsecase});t.getReferralController=a},function(e,t,r){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const o=n(r(109)),s=n(r(110)),a=o.default();t.createReferralUsecase=a;const u=s.default();t.getReferralUsecase=u},function(e,t,r){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const o=n(r(0)),s=r(2),a=r(1);t.default=function(){return async function({source:e,body:t}){const r=await a.getPgConnection();try{const n="SP/"+(new Date).getTime(),u=await s.findOne({strTableName:"tbl_referral_users",strWhere:` WHERE "strMobile" = '${t.strMobile}' AND "chrStatus" = 'N' `});if(u&&u.id)throw new o.default("THIS USER ALREADY REFERRED !!");const i=await s.findRoe(),c=' ("strMobile","intLevel","fkReferalById","intRewardAmount","roe","strReferralCode","fkParentId","createdBy","createdTime") ',l=` ('${t.strMobile}',1,${e.intUserId},50,${i.roe},'${n}',0,${e.intUserId},'${e.timReceived}') `;let d="";await r.query("BEGIN");const f=await s.transQueryRunner({strQuery:`INSERT INTO tbl_referral_users ${c} VALUES ${l} RETURNING *; `,objDbConnection:r}),_=await async function(e){const t=await a.getPgConnection();try{const r=`SELECT * FROM  tbl_referral_users WHERE "fkUserId" = ${e} ORDER BY "intLevel" ASC LIMIT 2;`,n=await t.query(r);return console.log(n.rows[0]),n.rows}catch(e){throw new o.default(e)}finally{t.end()}}(e.intUserId);if(_&&_.length&&_[0].fkReferalById&&f&&f[0]?(d+=` ('${t.strMobile}',2,${_[0].fkReferalById},20,${i.roe},'${n}',${f[0].id},${e.intUserId},'${e.timReceived}'),`,_[1]&&_[1].fkReferalById?d+=` ('${t.strMobile}',3,${_[1].fkReferalById},10,${i.roe},'${n}',${f[0].id},${e.intUserId},'${e.timReceived}'); `:(d=d.slice(0,-1),d+=";")):(d=d.slice(0,-1),d+=";"),""!=d){const e=await s.transQueryRunner({strQuery:`INSERT INTO tbl_referral_users ${c} VALUES ${d} `,objDbConnection:r});if(await r.query("COMMIT"),e)return{strMessage:"Success",strReferralCode:n};throw new o.default("FAILED")}return{strMessage:"Success",strReferralCode:n}}catch(e){throw await r.query("ROLLBACK"),new o.default(e)}finally{r.end()}}}},function(e,t,r){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const o=n(r(0)),s=r(2);t.default=function(){return async function({source:e,body:t}){try{let r="WHERE r.\"chrStatus\" ='N' ";"CUSTOMER"==e.strUserType?r+=` AND r."fkReferalById" = ${e.intUserId} `:t.fkReferalById&&(r+=` AND r."fkReferalById" = ${t.fkReferalById} `),t.strReferralStatus&&(r+=` AND r."strReferralStatus" = '${t.strReferralStatus}' `),t.id?r+=` AND r."fkParentId" = ${t.id} `:r+=' AND r."intLevel" = 1 ';const n=t.intLimit||100;console.log(`${a} ${r} LIMIT ${n} ;`);return{arrList:(await s.commonQueryRunner({strQuery:`${a} ${r} LIMIT ${n} ;`})).rows||[]}}catch(e){throw new o.default(e)}}};const a=' \nSELECT \nr.id ,\nr."strMobile",\nr."strReferralCode",\nr."strReferralStatus",\nr."intLevel",\nr."fkReferalById",\nr."fkUserId",\nr."fkParentId",\nr."intRewardAmount",\nr."roe",\nrb."strFirstName"    AS "strUser",\nu."strFirstName",\nto_char(r."createdTime", \'DD MON YYYY at HH12:MI:SS PM\') as "createdTime" \nFROM tbl_referral_users AS r\nLEFT JOIN tbl_user               AS rb                                       \n        ON rb.id = r."fkReferalById"\nLEFT JOIN tbl_user               AS u                                       \nON u.id = r."fkUserId"   '},function(e,t,r){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const o=n(r(0));t.createReferralControllerFactory=function({createReferralUsecase:e}){return async function({body:t,...r}){try{return{body:await e({source:r,body:t})}}catch(e){return new o.default(e).send()}}},t.getReferralControllerFactory=function({getReferralUsecase:e}){return async function({body:t,...r}){try{return{body:await e({source:r,body:t})}}catch(e){return new o.default(e).send()}}}},function(e,t,r){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const o=n(r(3)),s=r(1),a=r(113);let u=o.default.Router();u.get("/get_course",s.makeController(a.getCourseController)),u.post("/create_level",s.makeController(a.createCourseLevelController)),u.post("/create_vedio",s.makeController(a.createVedioController)),u.put("/update_level",s.makeController(a.updateCourseLevelController)),u.delete("/delete_level",s.makeController(a.deleteCourseLevelController)),u.delete("/delete_vedio",s.makeController(a.deleteVedioController)),u.post("/create_questens",s.makeController(a.createQuestensController)),u.post("/get_questens",s.makeController(a.getQuestensController)),u.post("/create_answer",s.makeController(a.createAnswerController)),u.post("/get_vedio",s.makeController(a.getVedioController)),e.exports=u},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(114),o=r(125),s=o.getCourseControllerFactory({getCourseUsecase:n.getCourseUsecase});t.getCourseController=s;const a=o.createCourseLevelControllerFactory({createCourseLevelUsecase:n.createCourseLevelUsecase});t.createCourseLevelController=a;const u=o.createVedioControllerFactory({createVedioUsecase:n.createVedioUsecase});t.createVedioController=u;const i=o.updateCourseLevelControllerFactory();t.updateCourseLevelController=i;const c=o.deleteCourseLevelControllerFactory();t.deleteCourseLevelController=c;const l=o.deleteVedioControllerFactory();t.deleteVedioController=l;const d=o.createQuestensControllerFactory({createQuestenUsecase:n.createQuestenUsecase});t.createQuestensController=d;const f=o.getQuestensControllerFactory({getQuestenUsecase:n.getQuestenUsecase});t.getQuestensController=f;const _=o.createAnswerControllerFactory({createAnswerlUsecase:n.createAnswerlUsecase});t.createAnswerController=_;const y=o.getVedioControllerFactory();t.getVedioController=y},function(e,t,r){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const o=r(115),s=n(r(118)),a=n(r(119)),u=n(r(120)),i=n(r(122)),c=n(r(123)),l=n(r(124)),d=u.default();t.getCourseUsecase=d;const f=s.default({courseLevelEntity:o.courseLevelEntity});t.createCourseLevelUsecase=f;const _=a.default();t.createVedioUsecase=_;const y=i.default();t.createQuestenUsecase=y;const E=c.default();t.getQuestenUsecase=E;const w=l.default({examinationEntity:o.examinationEntity});t.createAnswerlUsecase=w},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(116),o=r(117),s=n.courseLevelEntityFactory();t.courseLevelEntity=s;const a=o.examinationEntityFactory();t.examinationEntity=a},function(e,t,r){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const o=n(r(0));t.courseLevelEntityFactory=function(){return async function({strName:e,fkCourseId:t,intLevelOrder:r,jsnDetails:n,createdTime:s,createdBy:a}){try{let n=new o.default;if(!e&&e.length<4&&n.add("NAME_LENGTH_LESS"),t||n.add("COURSE ID MISSING"),n.isError)throw n;return{strCourseLevelQuery:` INSERT INTO tbl_level \n                ("strName",\n                "fkCourseId",\n                "intLevelOrder",\n                "createdBy",\n                "createdTime") VALUES ('${e}',${t},\n                                       ${r||'(select max("intLevelOrder")+1 from tbl_level  where "fkCourseId"='+t+" limit 1)"},\n                                        ${a},'${s}') RETURNING * ;`,strQuizzQuery:`INSERT INTO tbl_quiz ("fkLevelId",\n                "fkCourseId",\n                "createdBy",\n                "createdTime") VALUES ('{LEVEL_ID}',${t}, ${a},'${s}')`,strDiscussionQuery:`INSERT INTO tbl_discussion ("fkLevelId",\n                "fkCourseId",\n                "createdBy",\n                "createdTime") VALUES ('{LEVEL_ID}',${t}, ${a},'${s}')`}}catch(e){throw new o.default(e)}}}},function(e,t,r){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const o=n(r(0));t.examinationEntityFactory=function(){return async function({arrAnswer:e,fkCourseId:t,fkLevelId:r,objQuesten:n,createdTime:s,createdBy:a}){try{let u='INSERT INTO tbl_user_answer ("fkQuestenId",\n            "fkUserId",\n            "strAnswer",\n            "strResult", "createdBy","createdTime") VALUES ',i=0,c=[];if(!e)throw new o.default("ANSWER IS EMTRY");e.forEach((e,t)=>{c[t]=e,c[t].strAnswer=n[e.id],e.strAnswer==n[e.id]?(i+=1,c[t].result="TRUE"):c[t].result="FALSE",u+=`(${e.id},${a},  '${e.strAnswer}',\n                                '${e.strAnswer==n[e.id]?"TRUE":"FALSE"}',\n                                 ${a},'${s}'),`});const l=i>=1?"PASS":"FAIL";let d=`INSERT INTO tbl_exam_result ("fkLevelId",\n            "fkCourseId",\n            "strResult",\n            "intMark",\n            "createdBy",\n            "createdTime") VALUES (${r},${t},'${l}',${i},${a},'${s}') ;`,f=`INSERT INTO tbl_level_unlock ("fkLevelId",\n            "fkCourseId",\n            "createdBy",\n            "createdTime") VALUES (${r},${t},${a},'${s}');`;return u=u.slice(0,-1),u+=";",{intMark:i,strResult:l,strAnswerQuery:u,strExamResultQuery:d,strLevelUnloackQuery:f,arrResult:c}}catch(e){throw new o.default(e)}}}},function(e,t,r){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const o=n(r(0)),s=r(2),a=r(1);t.default=function({courseLevelEntity:e}){return async function({source:t,body:r}){const n=await a.getPgConnection();try{const a=await e({...r,createdTime:t.timReceived,createdBy:t.intUserId||0});console.log("objCourseLevelEntity"),console.log(a),await n.query("BEGIN");const u=await s.transQueryRunner({strQuery:a.strCourseLevelQuery,objDbConnection:n});if(u&&u[0]){const e=await s.transQueryRunner({strQuery:a.strQuizzQuery.replace("{LEVEL_ID}",u[0].id),objDbConnection:n}),t=await s.transQueryRunner({strQuery:a.strDiscussionQuery.replace("{LEVEL_ID}",u[0].id),objDbConnection:n});if(e&&t)return await n.query("COMMIT"),{strMessage:"Success"};throw await n.query("ROLLBACK"),new o.default("Failed")}throw await n.query("ROLLBACK"),new o.default("Failed")}catch(e){throw await n.query("ROLLBACK"),new o.default(e)}finally{n.end()}}}},function(e,t,r){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const o=n(r(0)),s=r(2);t.default=function(){return async function({source:e,body:t}){try{if(t.arrVedios&&t.arrVedios.length){let r='INSERT INTO tbl_vedios ("strVedioName","strUrl","fkLevelId","fkCourseId", "discription",\n                                                      "imgUrl","intVedioOrder","duration","createdBy", "createdTime") VALUES ';t.arrVedios.forEach(n=>{r+=` ('${n.strVedioName}','${n.strUrl}',${n.fkLevelId},${t.fkCourseId},'${n.discription||""}',\n                                 '${n.imgUrl}','${n.intVedioOrder}','${n.duration}',${e.intUserId},'${e.timReceived}'),`}),r=r.slice(0,-1),r+=";";const n=await s.commonQueryRunner({strQuery:r});if(n&&n.rowCount)return{strMessage:"VEDIOS CREATED"};throw new o.default("VEDIOS CREATION FAILED")}throw new o.default("NO VEDIO FOUND !!")}catch(e){throw new o.default(e)}}}},function(e,t,r){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const o=n(r(0)),s=r(2),a=r(1),u=n(r(121));t.default=function(){return async function({source:e,body:t}){const r=await a.getPgConnection();try{const t=await s.getQueryRunner({strQuery:u.default.strCourseFromPackageId.replace("{PAKAGE_ID}",e.fkPackageId),objDbConnection:r});if(t&&t.rows&&t.rows[0]&&t.rows[0].id){const e=t.rows[0].id,n=await s.getQueryRunner({strQuery:u.default.strLevels.replace("{COURSE_ID}",e),objDbConnection:r}),o=await s.getQueryRunner({strQuery:u.default.strVedios.replace("{COURSE_ID}",e),objDbConnection:r});let a={};o.rows.length&&await o.rows.forEach(e=>{a[e.fkLevelId]?a[e.fkLevelId][a[e.fkLevelId].length]=e:a[e.fkLevelId]=[e]});let i=[];return n.rows&&await n.rows.forEach((e,t)=>{i[t]={...e,arrVedios:a[e.id]||[]}}),{...t.rows[0],arrLevels:i}}throw new o.default("THIS PACKAGE HAS NO COUSE !!")}catch(e){throw new o.default(e)}finally{r.end()}}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n={strCourseFromPackageId:'\n    SELECT \n    c.id ,\nc."strCourseName",\nc."intTotalLevels",\nc."intCoursePrice",\nc."strCurrencyCode",\nc."imgUrl",\nc."jsnDetails",\nm."strFirstName"    AS "strMentorName",\nm."strMobile"       AS "strMentorMobile"\n \nFROM tbl_package AS p\nLEFT JOIN \ttbl_course               AS c                                       \n             ON c.id = p."fkCourseId"\nLEFT JOIN tbl_user               AS m                                       \n            ON m.id = c."fkMentorId"  \nWHERE p.id= {PAKAGE_ID} ;',strLevels:'SELECT *, to_char("createdTime", \'DD MON YYYY at HH12:MI:SS AM\') as "createdTime"  FROM tbl_level WHERE "chrStatus"=\'N\' AND "fkCourseId" = {COURSE_ID} ORDER BY "intLevelOrder" ASC ;',strVedios:'SELECT *, to_char("createdTime", \'DD MON YYYY at HH12:MI:SS AM\') as "createdTime"  FROM tbl_vedios WHERE "chrStatus"=\'N\' AND  "fkCourseId" = {COURSE_ID} ORDER BY "intVedioOrder" ASC ;'};t.default=n},function(e,t,r){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const o=n(r(0)),s=r(2);t.default=function(){return async function({source:e,body:t}){try{if(!t.fkLevelId||!t.fkCourseId)throw new o.default("CHOOSE A QUIZE!!");if(t.arrQuestens&&t.arrQuestens.length){let r='INSERT INTO tbl_questen ("jsnQuesten",\n                "fkLevelId",\n                "fkCourseId",\n                "fkQuizId",\n                "imgUrl",\n                "strAnswer","intQuestenOrder","createdBy", "createdTime") VALUES ';t.arrQuestens.forEach(n=>{r+=` ('{\n                        "type":"mcq",\n                        "strQuesten":"${n.strQuesten}",\n                        "A":"${n.A}",\n                        "B":"${n.B}",\n                        "C":"${n.C}",\n                        "D":"${n.D}"\n                    }',${t.fkLevelId},${t.fkCourseId},1,'${n.imgUrl} || ""',\n                    '${n.strAnswer}',${n.intQuestenOrder},${e.intUserId},'${e.timReceived}'),`}),r=r.slice(0,-1),r+=";";const n=await s.commonQueryRunner({strQuery:r});if(n&&n.rowCount)return{strMessage:"QuestenS CREATED"};throw new o.default("QuestenS CREATION FAILED")}throw new o.default("NO Questen FOUND !!")}catch(e){throw new o.default(e)}}}},function(e,t,r){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const o=n(r(0)),s=r(2);t.default=function(){return async function({source:e,body:t}){try{let r="WHERE q.\"chrStatus\" ='N' ";if(!t.fkCourseId||!t.fkLevelId)throw new o.default("QUIZZ ID NOT FOUND");r+=` AND q."fkCourseId" = ${t.fkCourseId} AND q."fkLevelId" = ${t.fkLevelId} `;return{arrList:(await s.commonQueryRunner({strQuery:"CUSTOMER"==e.strUserType?a.replace("{WHERE}",r):u.replace("{WHERE}",r)})).rows||[]}}catch(e){throw new o.default(e)}}};const a=' \nSELECT q.id,\nq."jsnQuesten",\nq."fkLevelId",\nq."fkCourseId",\nq."imgUrl",\nq."intQuestenOrder",\nl."strName" AS "strLevelName",\nc."strCourseName"\nFROM tbl_questen AS q\nLEFT JOIN tbl_level               AS l                                       \n        ON l.id = q."fkLevelId"\nLEFT JOIN tbl_course               AS c                                      \nON c.id = q."fkCourseId"   {WHERE} ORDER BY q."intQuestenOrder" ASC ;',u=' \nSELECT q.id,\nq."jsnQuesten",\nq."fkLevelId",\nq."fkCourseId",\nq."imgUrl",\nq."strAnswer",\nq."intQuestenOrder",\nl."strName" AS "strLevelName",\nc."strCourseName"\nFROM tbl_questen AS q\nLEFT JOIN tbl_level               AS l                                       \n        ON l.id = q."fkLevelId"\nLEFT JOIN tbl_course               AS c                                      \nON c.id = q."fkCourseId"   {WHERE} ORDER BY q."intQuestenOrder" ASC ;'},function(e,t,r){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const o=n(r(0)),s=r(2),a=r(1);t.default=function({examinationEntity:e}){return async function({source:t,body:r}){const n=await a.getPgConnection();try{if(!r.fkLevelId)throw new o.default("Level Id missing");const a=await s.getQueryRunner({strQuery:`SELECT id,"strAnswer" FROM tbl_questen WHERE "chrStatus" = 'N' AND "fkLevelId" = ${r.fkLevelId} ;`,objDbConnection:n});let u={};if(!a||!a.rows)throw new o.default("EXAM MISSING");a.rows.forEach(e=>{u[e.id]=e.strAnswer});const i=await e({...r,objQuesten:u,createdTime:t.timReceived,createdBy:t.intUserId||0});await n.query("BEGIN");const c=await s.transQueryRunner({strQuery:i.strExamResultQuery,objDbConnection:n});return await s.transQueryRunner({strQuery:i.strAnswerQuery,objDbConnection:n}),"PASS"==i.strResult&&await s.transQueryRunner({strQuery:i.strLevelUnloackQuery,objDbConnection:n}),await n.query("COMMIT"),c?{strMessage:"EXAM PASSED",strResult:i.strResult,intMark:i.intMark,arrResult:i.arrResult}:{strMessage:"EXAM FAILED",strResult:i.strResult,intMark:i.intMark,arrResult:i.arrResult}}catch(e){throw await n.query("ROLLBACK"),new o.default(e)}finally{n.end()}}}},function(e,t,r){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const o=n(r(0)),s=r(2),a=r(1);t.createCourseLevelControllerFactory=function({createCourseLevelUsecase:e}){return async function({body:t,...r}){try{return{body:await e({source:r,body:t})}}catch(e){return new o.default(e).send()}}},t.createVedioControllerFactory=function({createVedioUsecase:e}){return async function({body:t,...r}){try{return{body:await e({source:r,body:t})}}catch(e){return new o.default(e).send()}}},t.getCourseControllerFactory=function({getCourseUsecase:e}){return async function({body:t,...r}){try{return{body:await e({source:r,body:t})}}catch(e){return new o.default(e).send()}}},t.createQuestensControllerFactory=function({createQuestenUsecase:e}){return async function({body:t,...r}){try{return{body:await e({source:r,body:t})}}catch(e){return new o.default(e).send()}}},t.getQuestensControllerFactory=function({getQuestenUsecase:e}){return async function({body:t,...r}){try{return{body:await e({source:r,body:t})}}catch(e){return new o.default(e).send()}}},t.createAnswerControllerFactory=function({createAnswerlUsecase:e}){return async function({body:t,...r}){try{return{body:await e({source:r,body:t})}}catch(e){return new o.default(e).send()}}},t.updateCourseLevelControllerFactory=function(){return async function({body:e,...t}){try{return await s.commonQueryRunner({strQuery:`UPDATE tbl_level SET "strName" = '${e.strName}',\n                "updatedBy" = ${t.intUserId},\n                "updatedTime" = '${t.timReceived}' WHERE id =  ${e.id} ;`}),{body:{strMessage:"UPDATION SUCCESS"}}}catch(e){return new o.default(e).send()}}},t.deleteCourseLevelControllerFactory=function(){return async function({body:e,...t}){const r=await a.getPgConnection();try{const n=await s.commonQueryRunner({strQuery:`SELECT * FROM tbl_vedios WHERE "fkLevelId" = ${e.id} AND "chrStatus" = 'N' ; `});if(n&&n.rows&&n.rows.length)throw new o.default("COULD NOT DELETE LEVEL !!, LEVELS CONTAINS SOME VEDIOS ");return await r.query("BEGIN"),await s.transQueryRunner({strQuery:`UPDATE tbl_level SET "chrStatus" = 'D',\n                     "deletedBy" = ${t.intUserId},\n                    "deletedTime" = '${t.timReceived}' WHERE id =  ${e.id} ;`,objDbConnection:r}),await s.transQueryRunner({strQuery:`UPDATE tbl_quiz SET \n                    "chrStatus" = 'D',\n                    "deletedBy" = ${t.intUserId},\n                    "deletedTime" = '${t.timReceived}' WHERE "fkLevelId" = ${e.id} AND "chrStatus" = 'N' ;`,objDbConnection:r}),await s.transQueryRunner({strQuery:`UPDATE tbl_discussion SET \n                    "chrStatus" = 'D',\n                    "deletedBy" = ${t.intUserId},\n                    "deletedTime" = '${t.timReceived}' WHERE "fkLevelId" = ${e.id} AND "chrStatus" = 'N' ;`,objDbConnection:r}),await r.query("COMMIT"),{body:{strMessage:"DELETE SUCCESS"}}}catch(e){await r.query("ROLLBACK");return new o.default(e).send()}}},t.deleteVedioControllerFactory=function(){return async function({body:e,...t}){try{return await s.commonQueryRunner({strQuery:`UPDATE tbl_vedios SET "chrStatus" = 'D',\n                "deletedBy" = ${t.intUserId},\n                "deletedTime" = '${t.timReceived}' WHERE id =  ${e.id} ;`}),{body:{strMessage:"DELETE SUCCESS"}}}catch(e){return new o.default(e).send()}}},t.getVedioControllerFactory=function(){return async function({body:e,...t}){try{if(!e.fkLevelId)throw new o.default("LEVEL ID MISSING");const t=await s.commonQueryRunner({strQuery:`SELECT *  FROM tbl_vedios WHERE "chrStatus" = 'N' AND  "fkLevelId" =  ${e.fkLevelId} ;`});return{body:{arrList:t&&t.rows&&t.rows[0]?t.rows:[]}}}catch(e){return new o.default(e).send()}}}},function(e,t,r){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const o=n(r(3)),s=r(1),a=r(127);let u=o.default.Router();u.post("/create_news",s.makeController(a.createNewsController)),u.delete("/delete_news",s.makeController(a.deleteNewsController)),u.post("/get_news",s.makeController(a.getNewsController)),e.exports=u},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(128),o=r(130),s=n.createNewsControllerFactory({createNewsUsecase:o.createNewsUsecase});t.createNewsController=s;const a=n.deleteNewsControllerFactory();t.deleteNewsController=a;const u=n.getNewsControllerFactory();t.getNewsController=u},function(e,t,r){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const o=n(r(0)),s=r(2),a=n(r(129)),u=r(2),i=r(1);t.createNewsControllerFactory=function({createNewsUsecase:e}){return async function({body:t,...r}){try{return{body:await e({source:r,body:t})}}catch(e){return new o.default(e).send()}}},t.deleteNewsControllerFactory=function(){return async function({body:e,...t}){try{return"COMMENT"==e.APItype?await s.commonQueryRunner({strQuery:`UPDATE tbl_comments SET "chrStatus" = 'D',\n                "deletedBy" = ${t.intUserId},\n                "deletedTime" = '${t.timReceived}' WHERE id =  ${e.id} ;`}):await s.commonQueryRunner({strQuery:`UPDATE tbl_news SET "chrStatus" = 'D',\n                "deletedBy" = ${t.intUserId},\n                "deletedTime" = '${t.timReceived}' WHERE id =  ${e.id} ;`}),{body:{strMessage:"DELETE SUCCESS"}}}catch(e){return new o.default(e).send()}}},t.getNewsControllerFactory=function(){return async function({body:e,...t}){const r=await i.getPgConnection();try{if("COMMENT"==e.APItype){const t=await u.getQueryRunner({strQuery:a.default.strCommentsCount.replace("{LEVEL_ID}",e.fkLevelId),objDbConnection:r});if(!t.rows[0].intTotalCount||"0"==t.rows[0].intTotalCount)throw new o.default("NO  DATA");const n=`  ${e.intPerPage||20} OFFSET ${e.intSkip||0} ;`,s=await u.getQueryRunner({strQuery:a.default.strGetComments.replace("{REPLACE}",` n."fkLevelId" = ${e.fkLevelId} ORDER BY n.id ASC LIMIT ${n} `),objDbConnection:r}),i=s&&s.rows&&s.rows[0]?s.rows:[];return{body:{...t.rows[0],arrList:i}}}{const t=await u.getQueryRunner({strQuery:a.default.strCount,objDbConnection:r});if(!t.rows[0].intTotalCount||"0"==t.rows[0].intTotalCount)throw new o.default("NO NEWS DATA");const n=`  ${e.intPerPage||20} OFFSET ${e.intSkip||0} ;`,s=await u.getQueryRunner({strQuery:a.default.strGetNews.replace("{LIMITS}",n),objDbConnection:r}),i=s&&s.rows&&s.rows[0]?s.rows:[];return{body:{...t.rows[0],arrList:i}}}}catch(e){return new o.default(e).send()}finally{r.end()}}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n={strGetNews:'\n    SELECT n.id,\n    n."chrType",\n    n."jsnDetails",\n    m."strFirstName",\n    m."strImageUrl"  ,\n    to_char( n."createdTime", \'DD MONTH at HH12:MI PM\') as "createdTime"    \n    FROM tbl_news AS n\nLEFT JOIN tbl_user               AS m                                       \nON m.id = n."createdBy" \nWHERE n."chrStatus" = \'N\' \nORDER BY n.id ASC LIMIT {LIMITS} ;\n    ',strGetComments:'\n    SELECT n.id,\n    n."strType",\n    n."jsnDetails",\n    n."fkLevelId",\n    m."strFirstName",\n    m."strImageUrl"  ,\n    to_char( n."createdTime", \'DD MONTH at HH12:MI PM\') as "createdTime"    \n    FROM tbl_comments AS n\nLEFT JOIN tbl_user               AS m                                       \nON m.id = n."createdBy" \nWHERE n."chrStatus" = \'N\' AND {REPLACE}  ;\n',strCount:'SELECT COUNT(*) AS "intTotalCount" FROM tbl_comments WHERE  "chrStatus" = \'N\' ',strCommentsCount:'SELECT COUNT(*) AS "intTotalCount" FROM tbl_news WHERE  "chrStatus" = \'N\' AND "fkLevelId" = {LEVEL_ID} '};t.default=n},function(e,t,r){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const o=n(r(131)).default();t.createNewsUsecase=o},function(e,t,r){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const o=n(r(0)),s=r(2);t.default=function(){return async function({source:e,body:t}){try{console.log("\n\n\n",t.jsnDetails),console.log(JSON.stringify(t.jsnDetails));let r="";if("COMMENT"==t.APItype){if(!t.fkLevelId)throw new o.default("LEVEL ID MISSING");r=`INSERT INTO tbl_comments ("jsnDetails","strType","fkLevelId","createdBy", "createdTime") VALUES\n                ('${JSON.stringify(t.jsnDetails)}','${t.strType||"TEXT"}',${t.fkLevelId},${e.intUserId},'${e.timReceived}') ;`}else r=`INSERT INTO tbl_news ("jsnDetails","createdBy", "createdTime") VALUES\n                 ('${JSON.stringify(t.jsnDetails)}',${e.intUserId},'${e.timReceived}') ;`;const n=await s.commonQueryRunner({strQuery:r});if(n&&n.rowCount)return{strMessage:"CREATED"};throw new o.default("FAILED")}catch(e){throw new o.default(e)}}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){for(var r in e)t.hasOwnProperty(r)||(t[r]=e[r])}(r(133))},function(e,t,r){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const o=r(1),s=r(4),a=n(r(0));t.jwtTokenChecking=async function(e,t,r){let n={"Content-Type":"application/json","Last-Modified":(new Date).toUTCString()};try{const u=await e.headers["x-access-token"]||e.headers.authorization;if(u){const i=await o.decryptString(s.STR_COMMON_DB_TENANT_ID,u);if(!i)return t.status(401).set(n).send(new a.default("INVALID_TOKEN_PROVIDED").send().body);{const t={issuer:"issuer",subject:"IP",audience:"ABDU"},n=await o.jwtVerify(i,t);e.intUserId=n.intUserId,e.fkPackageId=n.fkPackageId,e.strUserType=n.strUserType,r()}}else{if(console.log("test",s.objOpenAPI[e.originalUrl]),console.log("test",e.originalUrl),!s.objOpenAPI[e.originalUrl])return t.status(401).set(n).send(new a.default("AUTHORIZATION_TOKEN_HEADER_IS_MISSING").send().body);r()}}catch(e){return t.status(401).set(n).send(new a.default(e).send().body)}}}]);