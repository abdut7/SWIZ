!function(e){var t={};function n(r){if(t[r])return t[r].exports;var o=t[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)n.d(r,o,function(t){return e[t]}.bind(null,o));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=7)}([function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});class r extends Error{constructor(e,t="errCommon"){if(super(),this.isError=!1,Error.captureStackTrace(this,this.constructor),"errServer"==t&&(t="errCommon",console.log(`\n${(new Date).toUTCString()} :-`),console.log(e)),"object"==typeof e){if(void 0!==e.errCommon&&(this.errCommon=e.errCommon),void 0!==e.errModuleWise&&(this.errModuleWise=e.errModuleWise),void 0!==e.HTTP_R_S_Code&&(this.HTTP_R_S_Code=e.HTTP_R_S_Code),void 0!==e.isError&&(this.isError=e.isError),e.errCommon||e.errModuleWise||e.HTTP_R_S_Code)return this;this[t]=[],e instanceof Error?(console.log(`\n${(new Date).toUTCString()} :-`),console.log(e),this[t].push({strMessage:"SOMETHING_WENT_WRONG"})):this[t].push({strMessage:e.strMessage,objDetails:e.objDetails}),this.isError=!0}else e&&(this[t]=[],this[t].push({strMessage:e}),this.isError=!0)}add(e,t="errCommon"){if("errServer"==t&&(t="errCommon",console.log(`\n${(new Date).toUTCString()} :-`),console.log(e)),"object"==typeof e){if(void 0!==e.errCommon&&(this.errCommon=e.errCommon),void 0!==e.errModuleWise&&(this.errModuleWise=e.errModuleWise),void 0!==e.HTTP_R_S_Code&&(this.HTTP_R_S_Code=e.HTTP_R_S_Code),e.errCommon||e.errModuleWise||e.HTTP_R_S_Code)return this;void 0===this[t]&&(this[t]=[]),e instanceof Error?(console.log(`\n${(new Date).toUTCString()} :-`),console.log(e),this[t].push({strMessage:"SOMETHING_WENT_WRONG"})):this[t].push({strMessage:e.strMessage,objDetails:e.objDetails}),this.isError=!0}else void 0===this[t]&&(this[t]=[]),this[t].push({strMessage:e}),this.isError=!0}setStatus(e){return this.HTTP_R_S_Code=e,this}send({statusCode:e=400}={}){let t={errCommon:this.errCommon,errModuleWise:this.errModuleWise};return Object.keys(t).forEach(e=>void 0===t[e]?delete t[e]:""),this.HTTP_R_S_Code&&(e=this.HTTP_R_S_Code),{body:t,statusCode:e}}}t.default=r},function(e,t,n){"use strict";function r(e){for(var n in e)t.hasOwnProperty(n)||(t[n]=e[n])}Object.defineProperty(t,"__esModule",{value:!0}),r(n(13)),r(n(15)),r(n(21)),r(n(23)),r(n(26)),r(n(28)),r(n(29)),r(n(32))},function(e,t,n){"use strict";function r(e){for(var n in e)t.hasOwnProperty(n)||(t[n]=e[n])}Object.defineProperty(t,"__esModule",{value:!0}),r(n(36)),r(n(41)),r(n(59)),r(n(66)),r(n(68)),r(n(76)),r(n(80)),r(n(84))},function(e,t){e.exports=require("express")},function(e,t,n){"use strict";function r(e){for(var n in e)t.hasOwnProperty(n)||(t[n]=e[n])}Object.defineProperty(t,"__esModule",{value:!0}),r(n(17)),r(n(18)),r(n(19)),r(n(20))},function(e,t){e.exports=require("crypto-js")},function(e,t){e.exports=require("aws-sdk")},function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const o=r(n(3)),u=n(8),s=r(n(9)),i=r(n(10)),a=r(n(0)),c=r(n(11)),l=n(96),d=o.default();try{d.use(i.default()),d.use(l.jwtTokenChecking),d.use(s.default.json()),d.use(s.default.urlencoded({limit:"50mb",extended:!0})),d.use((function(e,t,n,r){e instanceof SyntaxError&&"body"in e?n.status(400).send({errCommon:[{strMessage:"INVALID_JSON"}]}):r()})),d.use("/",c.default),d.listen(u.intPort,(function(){console.log("App is listening on port "+u.intPort)}))}catch(e){console.log(new a.default(e).send().body)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.intPort=3002},function(e,t){e.exports=require("body-parser")},function(e,t){e.exports=require("cors")},function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});let o=r(n(3)).default.Router();o.use("/wallet",n(12)),o.use("/trade",n(90)),t.default=o},function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const o=r(n(3)),u=n(1),s=n(33);let i=o.default.Router();i.post("/create_wallet",u.makeController(s.createWalletController)),i.post("/get_wallet",u.makeController(s.getWalletController)),e.exports=i},function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const o=r(n(0)),u=r(n(14));t.makeController=function(e){return(t,n)=>{try{const r={body:t.body,query:t.query,params:t.params,ip:t.ip,authorization:t.get("x-access-token"),intUserId:t.intUserId,fkPackageId:t.fkPackageId,strUserType:t.strUserType,method:t.method,timReceived:u.default().format("M/D/YYYY hh:m:s a"),path:t.originalUrl,strAudience:(t.get("str-audience")||"").toUpperCase(),headers:{"Content-Type":t.get("Content-Type"),Referer:t.get("referer"),"User-Agent":t.get("User-Agent")}};e(r).then(({headers:e={"Content-Type":"application/json","Last-Modified":(new Date).toUTCString()},type:t="json",statusCode:r=200,body:o})=>{if(!o)throw new Error("EMPTY_RESPONSE");n.set(e),n.type(t),n.status(r).send(o)}).catch(e=>{let t=new o.default(e).send();n.status(t.statusCode).set({"Content-Type":"application/json","Last-Modified":(new Date).toUTCString()}).send(t.body)})}catch(e){let t=new o.default(e).send();n.status(t.statusCode).set({"Content-Type":"application/json","Last-Modified":(new Date).toUTCString()}).send(t.body)}}}},function(e,t){e.exports=require("moment")},function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const o=n(16),u=r(n(0)),s=n(4);t.getPgConnection=async function(){try{if(s.OBJ_DB_CONFIG){let e=await new o.Client(s.OBJ_DB_CONFIG);return await e.connect(),e}throw new u.default({strMessage:"CONFIGURATION_MISSING",objDetails:"DATABASE"},"errCommon")}catch(e){throw new u.default(e,"errServer")}}},function(e,t){e.exports=require("pg")},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.USER_MODULE="mdl_user"},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.STR_COMMON_DB_TENANT_ID="postgres",t.STR_COMMON_DB="postgres",t.STR_COMMON_DB_USER_NAME="postgres",t.STR_COMMON_DB_PASSWORD="root123",t.STR_BUCKET_URL="",t.INT_ESTIMATE_DELIVERY_DAYS=10,t.INT_MAX_MASTER_IMAGE_SIZE=100,t.INT_MAX_PRODUCT_IMAGE_SIZE=512,t.INT_MAX_PROFILE_IMAGE_SIZE=50,t.AWS_ACCESS_KEY_ID="AKIA444CFGVCED6W7VAA",t.AWS_SECRET_ACCESS_KEY="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",t.AWS_S3_LOCATION="ap-south-1",t.AWS_S3_MASTER_BUCKET="swizbay",t.AWS_BUCKET_URL="https://swizbay.s3.ap-south-1.amazonaws.com/",t.OBJ_DB_CONFIG={user:"ubuntu",host:"localhost",database:"TRD",password:"ubuntu",port:5432},t.OBJ_MASTER_TYPE={expense:!0,vendor:!0,purchase:!0,material:!0,rental_items:!0},t.OBJ_OPEN_TABLE={tbl_materia:!0,tbl_rental:!0},t.OBJ_Account_TYPE={SUPPLIER:!0,PARTY:!0,CASH:!0,BANK:!0,VENDOR:!0,SALARY:!0,PURCHASE_COMMISION:!0,OTHER_EXPENSE:!0,OTHER_INCOME:!0}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TBL_USER="tbl_user",t.TBL_ACCOUNT="tbl_account",t.TBL_Master="tbl_master"},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.objOpenAPI={"/user/login_user":!0,"/login_user":!0,"/get_drop_down":!0,"/common/get_drop_down":!0,"/create_user":!0,"/user/create_user":!0}},function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const o=r(n(22)),u=r(n(5)),s=r(n(0));t.hashString=function(e){return new Promise((function(t,n){try{e.length>0?o.default.genSalt(10,(function(n,r){o.default.hash(e,r,(function(e,n){t(n)}))})):n("NULL_INPUT_RECVD")}catch(e){throw new s.default(e)}}))},t.compareHashAndText=function(e,t){return new Promise((async function(n,r){try{if(e&&t){n(await o.default.compareSync(e,t))}else r("NULL_INPUT_RECVD")}catch(e){throw new s.default(e)}}))},t.encryptString=async function(e){return e?(await u.default.AES.encrypt(e,"ABDR")).toString():e},t.decryptString=async function(e,t){return t?(await u.default.AES.decrypt(t,"ABDR")).toString(u.default.enc.Utf8):t}},function(e,t){e.exports=require("bcryptjs")},function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const o=r(n(24)),u=r(n(0)),s=r(n(25));t.jwtSignIn=async function(e,t){try{let n=await s.default.readFileSync("./config/private.key","utf-8"),r=await({issuer:t.issuer,subject:t.subject,audience:t.audience,algorithm:"RS256"});return await o.default.sign(e,n,r)}catch(e){throw new u.default(e)}},t.jwtVerify=async function(e,t){try{let n=await s.default.readFileSync("./config/public.key","utf-8"),r={issuer:t.issuer,subject:t.subject,audience:t.audience,algorithm:"RS256"};return o.default.verify(e,n,r)}catch(e){throw new u.default(e)}},t.jwtDecode=async function(e){try{return o.default.decode(e,{complete:!0})}catch(e){throw new u.default(e)}}},function(e,t){e.exports=require("jsonwebtoken")},function(e,t){e.exports=require("fs")},function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const o=r(n(27)),u=r(n(0));async function s(){try{let e=await o.default.createClient();return console.log("redis connected"),e}catch(e){throw new u.default(e)}}t.initializeRedisConn=s,t.setRedisData=async function(e,t){let n=await s();try{return await n.on("error",(function(e){console.error(e)})),n.set(e,t,o.default.print)}catch(e){throw new u.default(e)}finally{await n.quit()}},t.getRedisData=async function(e){let t=await s();return new Promise((function(n,r){try{t.get(e,(function(e,t){t&&n(t),n(null)}))}catch(e){r(new u.default(e))}finally{t.quit()}}))},t.checkPartialKeyExist=async function(e){let t=await s();return new Promise((function(n,r){try{return t.keys(e+"*",(function(e,t){t&&n(t),n(null)}))}catch(e){r(new u.default(e))}finally{t.quit()}}))}},function(e,t){e.exports=require("redis")},function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const o=r(n(0));t.makeFileController=function(e){return(t,n)=>{try{const r={body:t.body,file:t.file,files:t.files,query:t.query,params:t.params,ip:t.ip,intUserId:t.intUserId,fkPackageId:t.fkPackageId,strUserType:t.strUserType,authorization:t.get("x-access-token"),method:t.method,timReceived:(new Date).toUTCString(),path:t.originalUrl,strAudience:(t.get("str-audience")||"").toUpperCase(),headers:{"Content-Type":t.get("Content-Type"),Referer:t.get("referer"),"User-Agent":t.get("User-Agent")}};e(r).then(({headers:e={"Content-Type":"text/plain","Last-Modified":(new Date).toUTCString()},type:t="json",statusCode:r=200,body:o})=>{if(!o)throw new Error("EMPTY_RESPONSE");n.set(e),n.type(t),n.status(r).send(o)}).catch(e=>{let t=new o.default(e).send();n.status(t.statusCode).set({"Content-Type":"application/json","Last-Modified":(new Date).toUTCString()}).send(t.body)})}catch(e){let t=new o.default(e).send();n.status(t.statusCode).set({"Content-Type":"application/json","Last-Modified":(new Date).toUTCString()}).send(t.body)}}}},function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const o=n(4),u=r(n(30)),s=r(n(31)),i=r(n(6));let a=`mdlmaster${Date.now()}.jpg`;i.default.config.update({accessKeyId:o.AWS_ACCESS_KEY_ID,secretAccessKey:o.AWS_SECRET_ACCESS_KEY,region:o.AWS_S3_LOCATION});let c=new i.default.S3,l=u.default({storage:s.default({s3:c,bucket:o.AWS_S3_MASTER_BUCKET,metadata:function(e,t,n){n(null,{fieldName:a})},key:function(e,t,n){n(null,a),e.body[a]="https://masteraxef.s3.ap-south-1.amazonaws.com/"+a}})});t.fileUploadToS3=l},function(e,t){e.exports=require("multer")},function(e,t){e.exports=require("multer-s3")},function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const o=n(4),u=r(n(6)),s=r(n(0));t.multiFilesToS3=async function({arrFiles:e}){try{await u.default.config.update({accessKeyId:o.AWS_ACCESS_KEY_ID,secretAccessKey:o.AWS_SECRET_ACCESS_KEY,region:o.AWS_S3_LOCATION});let t=await new u.default.S3,n={},r="mdlmaster"+Date.now(),s=".jpg";return{arrUrls:await Promise.all(e.map(async(e,u)=>{console.log(e.name);let i=await e.name.split(".");return console.log("arrFilename"),console.log(i),s=await i[i.length-1],n["strImgUrl_"+u]=`${o.AWS_BUCKET_URL}${u}${r}.${s}`,await t.putObject({Bucket:o.AWS_S3_MASTER_BUCKET,Body:e.data,Key:`${u}${r}.${s}`,ACL:"public-read"},(function(e,t){e&&console.log("Error uploading data: ",e)})),{status:!0,url:`${o.AWS_BUCKET_URL}${u}${r}.${s}`}})),...n}}catch(e){throw new s.default(e)}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(34),o=n(89),u=o.createWalletControllerFactory({createWalletUsecase:r.createWalletUsecase});t.createWalletController=u;const s=o.getWalletControllerFactory({getWalletUsecase:r.getWalletUsecase});t.getWalletController=s},function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const o=r(n(35)),u=r(n(88)),s=o.default();t.createWalletUsecase=s;const i=u.default();t.getWalletUsecase=i},function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const o=r(n(0)),u=n(2),s=n(1);t.default=function(){return async function({source:e,body:t}){const n=await s.getPgConnection();try{const r=await u.createDocId({strModule:"WALLET"}),o=await u.findRoe(),s=Number(o.roe)*Number(t.intCreditAmount),i=`$${t.intCreditAmount}(₹${s}) is added to account balance by ${t.strPayMethode}`,a="CASH_IN_HAND"!==t.strPayMethode?"COMPLETED":"REQUESTED",c=`INSERT INTO tbl_wallet_amount ("intCreditAmount","intBaseCreditAmount","roe","strText","userId",\n                                            "strPayMode", "strStatus","strDocId","createdBy","createdTime") VALUES \n                                 (${t.intCreditAmount},${s},${o.roe},'${i}',${e.intUserId},\n                                 '${t.strPayMethode}','${a}','${r}',${e.intUserId},'${e.timReceived}') RETURNING * ;`;return await n.query("BEGIN"),await u.transQueryRunner({strQuery:c,objDbConnection:n}),await n.query("COMMIT"),{strMessage:i,strDocId:r}}catch(e){throw await n.query("ROLLBACK"),new o.default(e)}finally{n.end()}}}},function(e,t,n){"use strict";function r(e){for(var n in e)t.hasOwnProperty(n)||(t[n]=e[n])}Object.defineProperty(t,"__esModule",{value:!0}),r(n(37)),r(n(38)),r(n(39)),r(n(40))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getIsoDate=function(e=new Date){return(e=new Date(e)).toISOString().replace(/T/," ").replace(/\..+/,"")}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getFormatedDate=function(e){return e?("0"+(e=new Date(e)).getDate()).slice(-2)+"/"+("0"+(e.getMonth()+1)).slice(-2)+"/"+e.getFullYear():null}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getDbDate=function(e,t="dd/MM/yyyy"){if(!e)return null;let n=e.split("/"),r="";return"dd/MM/yyyy"==t||"yyyy/MM/dd"==t?r=`${n[2]}/${n[1]}/${n[0]}`:"MM/dd/yyyy"==t&&(r=`${n[2]}/${n[0]}/${n[1]}`),r}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getDateFormatChanger=function(e,t){if(!e||!t)return null;let n,r,o;return n=(e=e.replace(/\-/g,"/")).split("/"),o=(t=t.replace(/\-/g,"/")).split("/"),0==o.indexOf("dd")&&(r=`${n[2]}/${n[1]}/${n[0]}`),1==o.indexOf("dd")&&(r=`${n[2]}/${n[0]}/${n[1]}`),r}},function(e,t,n){"use strict";function r(e){for(var n in e)t.hasOwnProperty(n)||(t[n]=e[n])}Object.defineProperty(t,"__esModule",{value:!0}),r(n(42)),r(n(45)),r(n(47)),r(n(50)),r(n(53)),r(n(56))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){for(var n in e)t.hasOwnProperty(n)||(t[n]=e[n])}(n(43))},function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const o=n(1),u=r(n(0)),s=r(n(44)),i={"-1":null,1:"mdl_chart_of_account",2:"mdl_chart_of_account",3:"mdl_chart_of_account",4:"mdl_bank_account",5:"mdl_credit_card",6:"mdl_corporate_card",7:"mdl_cash_account",8:"mdl_cheque_account",9:"mdl_cheque_account",10:"mdl_cheque_account",11:"",12:"",13:"",14:"mdl_customer",15:"mdl_supplier",16:"",17:"mdl_airline",18:"",19:"",20:"",21:""};t.accountIsExists=async function({intAccountPk:e=-1,strAccountCode:t="",strAccountName:n="",arrAccountType:r=[]}){let a=await o.getPgConnection();try{n=n.toUpperCase(),e=e||-1;let o,c=await a.query(s.default.strQueryAccountInfo,[e,t,n]),l=new u.default;for(let e of c.rows)o=r.includes(e.int_account_type)?"-1":e.int_account_type,e.strCode==t&&l.add({strMessage:"CODE_DUPLICATE",objDetails:i[o]},"errCommon"),e.strName==n&&l.add({strMessage:"NAME_DUPLICATE",objDetails:i[o]},"errCommon");return l}catch(e){throw new u.default(e)}finally{a.end()}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r={strQueryAccountInfo:'SELECT \n  vchr_third_party_mapping_code AS "strThirdPartyCode",\n  vchr_account_code             AS  "strCode",\n  UPPER(vchr_account_name)      AS   "strName",\n  vchr_display_name             AS    "strDisplayName",\n  int_account_type          \nFROM tbl_account \nWHERE (chr_document_status = \'N\' \n  AND pk_bint_account_id != $1)\n  AND (  vchr_third_party_mapping_code=$2\t\n      OR vchr_account_code=$3 \n      OR UPPER(vchr_account_name)=$4 \n      OR vchr_display_name=$5 )',strGetSystemMappingAccount:"SELECT \t\n               fk_bint_account_id AS \"intAccountPk\" \n      FROM tbl_system_mapping_accounts \n       WHERE vchr_system_mapping_code=$1 AND chr_document_status='N' ",strGetBankChargesAccount:'SELECT \n  b.fk_bint_bank_charge_account_id AS   "intAccountPk",\n  a.vchr_account_code              AS  "strCode",\n  a.vchr_account_name              AS   "strName"\n  FROM tbl_bank AS b\n  LEFT JOIN tbl_account     AS a                               \n     ON b.fk_bint_bank_account_id = a.pk_bint_account_id\n    WHERE   a.pk_bint_account_id = $1 AND b.chr_document_status=\'N\' ',strGetCreditCardChargesAccount:'\n  SELECT \n  pos.fk_bint_expense_acc_id AS   "intAccountPk",\n  a.vchr_account_code              AS  "strCode",\n  a.vchr_account_name              AS   "strName"\n  FROM tbl_credit_card_pos AS pos\n  JOIN tbl_account     AS a                               \n      ON  pos.fk_bint_expense_acc_id = a.pk_bint_account_id\n    WHERE   pos.pk_bint_credit_card_pos_id = $1 AND pos.chr_document_status=\'N\' '};t.default=r},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){for(var n in e)t.hasOwnProperty(n)||(t[n]=e[n])}(n(46))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.transactionIsExists=async function({strConnection:e,intTransactionPk:t}){}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){for(var n in e)t.hasOwnProperty(n)||(t[n]=e[n])}(n(48))},function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const o=r(n(0)),u=r(n(49));t.createDataLogsDb=async function({objMainDbConnection:e,strModuleName:t,arrJsonItems:n=[],intUserId:r,timCurrent:s,strReason:i=""}){try{let o=" ",a=" ";n.forEach(e=>{o+=`('${t}','${JSON.stringify(e).replace(/'/g,"''")}','${s}',${r}),`,i&&(a+=`(${e.intPk},\n           '${t}',\n           '${i.replace(/'/g,"''")}',\n           '${s}',\n            ${r}),`)}),o=o.slice(0,-1),a=a.slice(0,-1),await e.query(u.default.strQueryInsertIntoLogTbl+o),i&&await e.query(u.default.strQueryInsertDeleteResonTbl+a)}catch(e){throw new o.default(e)}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});let r={strQueryInsertIntoLogTbl:"INSERT INTO tbl_logs( vchr_module_name,\n                             json_log_item,\n                             time_created,\n                             fk_bint_created_user_id) VALUES ",strQueryInsertDeleteResonTbl:"INSERT INTO tbl_masters_delete_log( \n                              fk_bint_table_pk_id,           \n                              vchr_table_name,                \n                              txt_reason    , \n                              tim_created,               \n                              fk_bint_created_user_id)     VALUES       "};t.default=r},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){for(var n in e)t.hasOwnProperty(n)||(t[n]=e[n])}(n(51))},function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const o=n(1),u=r(n(0)),s=r(n(52));t.getPermission=async function({source:e,strModule:t}){let n=await o.getPgConnection();try{return(await n.query(s.default.strGetPermission,[e.intUserID,t])).rows[0]}catch(e){throw new u.default(e)}finally{n.end()}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r={strGetPermission:'SELECT        ugp.int_view                                 AS "intView",\n                                     ugp.int_add                                  AS "intAdd",\n                                     ugp.int_update                               AS "intUpdate",\n                                     ugp.int_delete                               AS "intDelete",\n                                     ugp.int_posting                              AS "intPosting",\n                                     ugp.int_print                                AS "intPrint",\n                                     ugp.int_reprint                              AS "intRePrint"\n                                 FROM tbl_user_group_menu_permission AS ugp\n                                 LEFT JOIN tbl_menu AS m \n                                  ON ugp.fk_bint_menu_id=m.pk_bint_menu_id\n                                 LEFT JOIN tbl_user_group AS ug\n                                  ON ug.pk_bint_user_group_id=ugp.fk_bint_user_group_id\n                                 LEFT JOIN tbl_user AS u\n                                  ON u.fk_bint_user_group_id=ug.pk_bint_user_group_id\n                                 WHERE   u.pk_bint_user_id               =$1\n                                     AND m.vchr_menu_name                =$2\n                                      '};t.default=r},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){for(var n in e)t.hasOwnProperty(n)||(t[n]=e[n])}(n(54))},function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const o=r(n(0)),u=r(n(55));t.getFinancialYearDb=async function(e,t){try{if(!t)return null;return(await e.query(u.default.strQueryGetFinancialYearSettingsTbl,[t])).rows[0]}catch(e){throw new o.default(e)}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});let r={strQueryGetFinancialYearSettingsTbl:'\n  SELECT \n  pk_bint_financial_year_id   AS "intPk",\n  dat_financial_year_start    AS "datStartDate",\n  dat_financial_year_end      AS "datEndDate",\n  chr_financial_year_status   AS "chrStatus"\n  FROM tbl_financial_year\n    WHERE (dat_financial_year_start, dat_financial_year_end) OVERLAPS ($1::DATE,$1::DATE) AND chr_document_status = \'N\' '};t.default=r},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){for(var n in e)t.hasOwnProperty(n)||(t[n]=e[n])}(n(57))},function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const o=r(n(0)),u=r(n(58)),s=n(2);t.getPkBasedNameDb=async function(e,t,n,r){try{let o={"{WANTED_FIELD_NAME}":""+t,"{TBL_NAME}":""+n,"{WHERE}":r+" AND chr_document_status = 'N' "};return t||n||r?(await e.query(s.multiReplace(u.default.strQueryGetPkOfTblAttribute,o))).rows:null}catch(e){throw new o.default(e)}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});let r={strQueryGetPkOfTblAttribute:"\n  SELECT  \n    {WANTED_FIELD_NAME}\n  FROM {TBL_NAME}\n  WHERE {WHERE}"};t.default=r},function(e,t,n){"use strict";function r(e){for(var n in e)t.hasOwnProperty(n)||(t[n]=e[n])}Object.defineProperty(t,"__esModule",{value:!0}),r(n(60)),r(n(61)),r(n(62)),r(n(63)),r(n(64)),r(n(65))},function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const o=n(1),u=r(n(0));t.insertQueryRunner=async function({strTableName:e,objValues:t,arrReturnItems:n=[]}){let r="",s="",i="",a=[],c=await o.getPgConnection();try{if(e){if(t&&Object.keys(t).length){await Object.keys(t).forEach((e,n)=>{s+=` ${e},`,i+=`$${n+1},`,a.push(t[e])}),r=`INSERT INTO ${e} (${s.slice(0,-1)}) VALUES (${i.slice(0,-1)}) ${n.length?"RETURNING "+n:" "} ;`,console.log("strQuery"),console.log(r);const o=await c.query(r,a);return console.log(o.rows[0]),o.rows}return null}return null}catch(e){throw e&&23505==e.code?new u.default("DUPLICATE ENTRY"):new u.default(e)}finally{c.end()}},t.insertTransQueryRunner=async function({strTableName:e,objValues:t,arrReturnItems:n=[],objDbConnection:r}){let o="",s="",i="",a=[];try{if(e){if(t&&Object.keys(t).length){await Object.keys(t).forEach((e,n)=>{s+=` ${e},`,i+=`$${n+1},`,a.push(t[e])}),o=`INSERT INTO ${e} (${s.slice(0,-1)}) VALUES (${i.slice(0,-1)}) ${n.length?"RETURNING "+n:" "} ;`,console.log("strQuery"),console.log(o);const u=await r.query(o,a);return console.log(u.rows[0]),u.rows}return null}return null}catch(e){throw await r.query("ROLLBACK"),e&&23505==e.code?new u.default("DUPLICATE ENTRY"):new u.default(e)}},t.insertWithAccQueryRunner=async function({strTableName:e,objValues:t,arrAccValues:n,arrReturnItems:r=[]}){let s="",i="",a="",c=[],l=await o.getPgConnection();try{if(e){if(t&&Object.keys(t).length){await l.query("BEGIN");const o=await l.query(" INSERT INTO tbl_account\n                                                 (str_account_name,\n                                                 str_account_type,\n                                                 fk_created_user_id,\n                                                 tim_created) VALUES ($1,$2,$3,$4) \n                                                 RETURNING pk_account_id",n);if(o&&o.rows&&o.rows[0]&&o.rows[0].pk_account_id){let n={fk_account_id:o.rows[0].pk_account_id,...t};await Object.keys(n).forEach((e,t)=>{i+=` ${e},`,a+=`$${t+1},`,c.push(n[e])}),s=`INSERT INTO ${e} (${i.slice(0,-1)}) VALUES (${a.slice(0,-1)}) ${r.length?"RETURNING "+r:" "} ;`;const u=await l.query(s,c);return console.log(u.rows[0]),await l.query("COMMIT"),u.rows}throw await l.query("ROLLBACK"),new u.default("FAILED")}return null}return null}catch(e){throw await l.query("ROLLBACK"),e&&23505==e.code?new u.default("ACCOUNT NAME DUPLICATE"):new u.default(e)}finally{l.end()}}},function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const o=n(1),u=r(n(0));t.commonQueryRunner=async function({strQuery:e}){const t=await o.getPgConnection();try{return await t.query(e)}catch(e){throw new u.default(e)}finally{t.end()}}},function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const o=n(1),u=r(n(0));t.findAll=async function({strTableName:e,strWhere:t="",strColounm:n=" * "}){const r=await o.getPgConnection();try{if(e&&t){const o=`SELECT ${n} FROM ${e} ${t} ;`;console.log("strQuery"),console.log(o);const u=await r.query(o);return console.log(u.rows[0]),u.rows}return null}catch(e){throw new u.default(e)}finally{r.end()}}},function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const o=n(1),u=r(n(0));t.findOne=async function({strTableName:e,strWhere:t="",strColounm:n=" * "}){const r=await o.getPgConnection();try{if(e&&t){const o=`SELECT ${n} FROM ${e} ${t} ;`;console.log("strQuery"),console.log(o);const u=await r.query(o);return u&&u.rows?u.rows[0]:null}return null}catch(e){throw new u.default(e)}finally{r.end()}}},function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const o=r(n(0));t.transQueryRunner=async function({strQuery:e,objDbConnection:t}){try{const n=await t.query(e);return n&&n.rows&&n.rows.length?n.rows:!!n.rowCount}catch(e){throw await t.query("ROLLBACK"),e&&23505==e.code?new o.default("DUPLICATE ENTRY"):new o.default(e)}}},function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const o=r(n(0));t.getQueryRunner=async function({strQuery:e,objDbConnection:t}){try{return await t.query(e)}catch(e){throw new o.default(e)}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){for(var n in e)t.hasOwnProperty(n)||(t[n]=e[n])}(n(67))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.escape=function(e){return e.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")}},function(e,t,n){"use strict";function r(e){for(var n in e)t.hasOwnProperty(n)||(t[n]=e[n])}Object.defineProperty(t,"__esModule",{value:!0}),r(n(69)),r(n(70)),r(n(71)),r(n(72)),r(n(73)),r(n(74)),r(n(75))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(2);t.ltrim=function(e,t="\\s"){return e?("\\s"!==t&&(t=r.escape(t)),e.replace(new RegExp("^["+t+"]+","gm"),"")):e}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(2);t.multiReplace=function(e,t){let n=[];for(let e in t)n.push(r.escape(e));return e.replace(new RegExp(n.join("|"),"g"),(function(e){return t[e]}))}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(2);t.rtrim=function(e,t="\\s"){return e?("\\s"!==t&&(t=r.escape(t)),e.replace(new RegExp("["+t+"]+$","gm"),"")):e}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.slugify=function(e,t="U",n="_"){return e?"L"==t?e.replace(/[^a-z0-9]/gi,n).toLowerCase():"U"==t?e.replace(/[^a-z0-9]/gi,n).toLocaleUpperCase():e.replace(/[^a-z0-9]/gi,n):e}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(2);t.trim=function(e,t="\\s"){return e?("\\s"!==t&&(t=r.escape(t)),e.replace(new RegExp("^["+t+"]+|["+t+"]+$","gm"),"")):e}},function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const o=r(n(5));t.encryptString=function(e,t){return t?o.default.AES.encrypt(t,"ABDU").toString():t}},function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const o=r(n(5));t.decryptString=function(e,t){return t?o.default.AES.decrypt(t,"ABDU").toString(o.default.enc.Utf8):t}},function(e,t,n){"use strict";function r(e){for(var n in e)t.hasOwnProperty(n)||(t[n]=e[n])}Object.defineProperty(t,"__esModule",{value:!0}),r(n(77)),r(n(78))},function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const o=r(n(0));t.getJSONToCSV=async function({arrItemList:e,objColumns:t=null,strMainTittle:n,intUserID:r}){try{let r=[],o=[],u=[],s=0;t&&t[Object.keys(t)[0]].forEach(e=>{1==e.blnShow&&(s++,o.push(e.strKey),u.push(e.strHeader))}),e.forEach(e=>{let t=[];o.forEach(n=>{t.push(e[n])}),r.push(t)});let i='"',a=",",c="",l=new Array(s);l[(u.length/2-1).toFixed(0)]=n,c=l+"\n",c+=u+"\n";let d=[];return r.forEach(e=>{let t="";d=e,d.forEach(e=>{t+=`${i}${e.toString()}${i},`}),c+=t+"\n"}),a+=a.replace(/,/g,a),c}catch(e){return new o.default(e)}}},function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const o=r(n(79)),u=r(n(0));t.getJSONToExcel=async function({arrItemList:e,objColumns:t=null,strMainTittle:n,intUserID:r}){try{let r=[],u=[],s=[];t&&t[Object.keys(t)[0]].forEach(e=>{e.blnShow,u.push(e.strKey),s.push(e.strHeader)});let i={"!cols":[]};s.forEach(e=>{i["!cols"].push({wch:e.length+3})});let a=new Array;return a[(s.length/2-1).toFixed(0)]=n,r.push(a),r.push(s),e.forEach(e=>{let t=[];u.forEach(n=>{t.push(e[n])}),r.push(t)}),o.default.build([{data:r}],i)}catch(e){return new u.default(e)}}},function(e,t){e.exports=require("node-xlsx")},function(e,t,n){"use strict";function r(e){for(var n in e)t.hasOwnProperty(n)||(t[n]=e[n])}Object.defineProperty(t,"__esModule",{value:!0}),r(n(81)),r(n(82)),r(n(83))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createDataLog=async function({objSession:e,arrOldItem:t,intUserId:n,strCreatedTime:r}){return!0}},function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const o=n(1),u=r(n(0));t.findRoe=async function(){const e=await o.getPgConnection();try{const t="SELECT * FROM  tbl_roe ORDER BY id DESC LIMIT 1 ;",n=await e.query(t);return console.log(n.rows[0]),n.rows[0]}catch(e){throw new u.default(e)}finally{e.end()}}},function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const o=n(1),u=r(n(0));t.findUserById=async function(e){const t=await o.getPgConnection();try{const n=`SELECT * FROM  tbl_user WHERE id = ${e} ;`,r=await t.query(n);return console.log(r.rows[0]),r.rows[0]}catch(e){throw new u.default(e)}finally{t.end()}}},function(e,t,n){"use strict";function r(e){for(var n in e)t.hasOwnProperty(n)||(t[n]=e[n])}Object.defineProperty(t,"__esModule",{value:!0}),r(n(85)),r(n(86)),r(n(87))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createDocId=function(e){return`SP/${e.strModule}/${(new Date).getTime()}`}},function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const o=r(n(0));t.updateWalletAmount=async function({userId:e,strDocId:t,intAmount:n,intBaseAmount:r,roe:u,timReceived:s,createdBy:i,objDbConnection:a}){try{const c=`SELECT id,"intAmount" FROM tbl_wallet_amount WHERE "userId" = ${e} AND "chrStatus"='N' ORDER BY DESC LIMIT 1`,{rows:l}=await a.query(c),d=l&&l[0]&&l[0].id?l[0].id:0,_=l&&l[0]&&l[0].intAmount?Number(l[0].intAmount)+n:0;if(_<0)throw new o.default("YOUR ACCOUNT HAVE NO PROPER BALANCE");const f=`UPDATE tbl_wallet_amount SET "chrStatus"='E'\n                                      "updatedBy" = ${i},\n                                      "updatedTime"='${s}'\n                                       WHERE ${d?"id ="+d:'"chrStatus"=\'N\' AND "userId"='+e}`,y=`INSERT INTO ("intAmount","intTotalAmount","intBaseAmount","roe",  "userId", "strDocId",  "createdBy",  "createdTime" ) \n                                       VALUES (${n},${_},${r},${u},${e},'${t}',${i},'${s}');`;await a.query(f);return await a.query(y)}catch(e){throw new o.default(e)}}},function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const o=r(n(0));t.getWalletAmount=async function({userId:e,objDbConnection:t}){try{const n=`${u} AND "userId" = ${e}`,{rows:r}=await t.query(n),o=r&&r[0]&&r[0]?r[0]:{intDebitAmount:0,intCreditAmount:0};return{intTotalAmont:Number(o.intCreditAmount)-Number(o.intDebitAmount),...o}}catch(e){throw new o.default(e)}};const u=' SELECT SUM("intDebitAmount") AS "intDebitAmount",\n                             SUM("intCreditAmount") AS "intCreditAmount"\n                             FROM tbl_wallet_amount\n                             WHERE  "chrStatus"=\'N\' AND "strStatus"=\'COMPLETED\''},function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const o=r(n(0)),u=n(2),s=n(1);t.default=function(){return async function({source:e,body:t}){const n=await s.getPgConnection();try{let r="WHERE w.\"chrStatus\" ='N' ",o={};"CUSTOMER"==e.strUserType&&(o=await u.getWalletAmount({objDbConnection:n,userId:e.intUserId}));const s=t.intLimit||100,a=await u.getQueryRunner({strQuery:`${i} ${r} LIMIT ${s} ;`,objDbConnection:n});return{...o,arrList:a.rows||[]}}catch(e){throw new o.default(e)}finally{n.end()}}};const i=' \nSELECT \nw.id ,\nw."intDebitAmount",\nw."intCreditAmount",\nw."intBaseDebitAmount",\nw."intBaseCreditAmount",\nw."roe",\nw."strText",\nw."strDocId",\nw."strPayMode",\nw."strStatus",\nu."strFirstName"    AS "strUser",\nto_char(w."createdTime", \'DD MON YYYY at HH12:MI:SS PM\') as "createdTime" \nFROM tbl_wallet_amount AS w\nLEFT JOIN tbl_user               AS u                                       \nON u.id = w."userId" '},function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const o=r(n(0));t.createWalletControllerFactory=function({createWalletUsecase:e}){return async function({body:t,...n}){try{return{body:await e({source:n,body:t})}}catch(e){return new o.default(e).send()}}},t.getWalletControllerFactory=function({getWalletUsecase:e}){return async function({body:t,...n}){try{return{body:await e({source:n,body:t})}}catch(e){return new o.default(e).send()}}}},function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const o=r(n(3)),u=n(1),s=n(91);let i=o.default.Router();i.post("/create_trade",u.makeController(s.createTradeController)),i.post("/get_trade",u.makeController(s.getTradeController)),e.exports=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(92),o=n(95),u=o.createTradeControllerFactory({createTradeUsecase:r.createTradeUsecase});t.createTradeController=u;const s=o.getTradeControllerFactory({getTradeUsecase:r.getTradeUsecase});t.getTradeController=s},function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const o=r(n(93)),u=r(n(94)),s=o.default();t.createTradeUsecase=s;const i=u.default();t.getTradeUsecase=i},function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const o=r(n(0)),u=n(2),s=n(1);t.default=function(){return async function({source:e,body:t}){const n=await s.getPgConnection();try{const r=await u.getWalletAmount({objDbConnection:n,userId:e.intUserId});if(t.intCreditAmount&&Number(t.intCreditAmount)>Number(r.intTotalAmont))throw new o.default("TRADE AMOUNT IS GRAITER THAN YOUR ACCOUNT BALANCE");const s=await u.createDocId({strModule:"TRADE"}),i=await u.findRoe(),a=Number(i.roe)*Number(t.intCreditAmount),c=`$${t.intCreditAmount} is added to Trade balance `,l=`$${t.intCreditAmount} is Debited from your Account,For Credits to Trade Account `,d=`INSERT INTO tbl_wallet_amount ("intDebitAmount","intBaseDebitAmount","roe","strText","userId",\n                                          "strPayMode", "strStatus","strDocId","createdBy","createdTime") VALUES \n                (${t.intCreditAmount},${a},${i.roe},'${l}',${e.intUserId},\n                'TRANSACTION','COMPLETED','${s}',${e.intUserId},'${e.timReceived}') RETURNING * ;`,_=`INSERT INTO tbl_trade_amount ("intCreditAmount","roe","strText","userId","strDocId","createdBy","createdTime") VALUES \n                                 (${t.intCreditAmount},${i.roe},'${c}',${e.intUserId},\n                                 '${s}',${e.intUserId},'${e.timReceived}') RETURNING * ;`;return await n.query("BEGIN"),await u.transQueryRunner({strQuery:_,objDbConnection:n}),await u.transQueryRunner({strQuery:d,objDbConnection:n}),await n.query("COMMIT"),{strMessage:c,strDocId:s}}catch(e){throw await n.query("ROLLBACK"),new o.default(e)}finally{n.end()}}}},function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const o=r(n(0)),u=n(2);t.default=function(){return async function({source:e,body:t}){try{let n="WHERE w.\"chrStatus\" ='N' ",r={};if("CUSTOMER"==e.strUserType){const t=await u.commonQueryRunner({strQuery:`${i} AND  "userId" = ${e.intUserId} ;`});r=t&&t.rows&&t.rows[0]?t.rows[0]:{intDebitAmount:"Sync...",intCreditAmount:"Sync..."}}const o=t.intLimit||100,a=await u.commonQueryRunner({strQuery:`${s} ${n} LIMIT ${o} ;`});return{...r,arrList:a.rows||[]}}catch(e){throw new o.default(e)}}};const s=' \nSELECT \nw.id ,\nw."intDebitAmount",\nw."intCreditAmount",\nw."roe",\nw."strText",\nw."strDocId",\nu."strFirstName"    AS "strUser",\nto_char(w."createdTime", \'DD MON YYYY at HH12:MI:SS PM\') as "createdTime" \nFROM tbl_trade_amount AS w\nLEFT JOIN tbl_user               AS u                                       \nON u.id = w."userId" ',i=' SELECT SUM("intDebitAmount") AS "intDebitAmount",\n                             SUM("intCreditAmount") AS "intCreditAmount",\n                             COUNT(*) FROM tbl_trade_amount\n                             WHERE  "chrStatus"=\'N\''},function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const o=r(n(0));t.createTradeControllerFactory=function({createTradeUsecase:e}){return async function({body:t,...n}){try{return{body:await e({source:n,body:t})}}catch(e){return new o.default(e).send()}}},t.getTradeControllerFactory=function({getTradeUsecase:e}){return async function({body:t,...n}){try{return{body:await e({source:n,body:t})}}catch(e){return new o.default(e).send()}}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){for(var n in e)t.hasOwnProperty(n)||(t[n]=e[n])}(n(97))},function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const o=n(1),u=n(4),s=r(n(0));t.jwtTokenChecking=async function(e,t,n){let r={"Content-Type":"application/json","Last-Modified":(new Date).toUTCString()};try{const i=await e.headers["x-access-token"]||e.headers.authorization;if(i){const a=await o.decryptString(u.STR_COMMON_DB_TENANT_ID,i);if(!a)return t.status(401).set(r).send(new s.default("INVALID_TOKEN_PROVIDED").send().body);{const t={issuer:"issuer",subject:"IP",audience:"ABDU"},r=await o.jwtVerify(a,t);e.intUserId=r.intUserId,e.fkPackageId=r.fkPackageId,e.strUserType=r.strUserType,n()}}else{if(console.log("test",u.objOpenAPI[e.originalUrl]),console.log("test",e.originalUrl),!u.objOpenAPI[e.originalUrl])return t.status(401).set(r).send(new s.default("AUTHORIZATION_TOKEN_HEADER_IS_MISSING").send().body);n()}}catch(e){return t.status(401).set(r).send(new s.default(e).send().body)}}}]);